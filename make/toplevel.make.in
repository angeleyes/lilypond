# -*-Makefile-*-
# title	   specific top level makefile for LilyPond  

# subdir level:
#
depth = .
#

# descent order into subdirectories:
#
SUBDIRS = scripts buildscripts  flower lib lily mf midi2ly po debian \
	Documentation ly input tex make mutopia intl stepmake\
	ps  scm
#

SCRIPTS = configure aclocal.m4
README_FILES =  DEDICATION COPYING NEWS TODO CHANGES
README_TXT_FILES = AUTHORS.txt README.txt INSTALL.txt 
IN_FILES := $(wildcard *.in)
EXTRA_DIST_FILES = dstreamrc lilypond-mode.el vimrc VERSION $(README_FILES)  $(SCRIPTS) $(IN_FILES) 
NON_ESSENTIAL_DIST_FILES = $(README_TXT_FILES)

# bootstrap stepmake:
#
STEPMAKE_TEMPLATES=toplevel yolily-toplevel po
include $(depth)/make/stepmake.make 
#

website: fonts htmldoc examples doc++

fonts:
	$(MAKE) -C $(depth)/mf 


examples:
	$(MAKE) CONFIGSUFFIX='www' -C input WWW
	$(MAKE) CONFIGSUFFIX='www' -C mutopia WWW
	$(footify-all-command)
	tar --exclude='*.dvi' --exclude='*.tex' --exclude='*.ps' --exclude='*.ppm' -czf $(outdir)/examples.tar.gz  `find input mutopia -type d -name 'out-www' -print`

localinstall:
	mkdir -p $(datadir)
	rm -f $(datadir)/cmtfm 
	$(LN_S) $(TEX_TFMDIR) $(datadir)/cmtfm

local-WWW-clean:
	$(SHELL) $(depth)/buildscripts/clean-fonts.sh

