#!/bin/sh
#
# project  LilyPond -- the musical typesetter
# title	   (bash/sh/ksh) script to setup library and auto generated files
# file	   configure-broken-system
#
# Copyright (c) 1997 by    
#	Han-Wen Nienhuys <hanwen@stack.nl>
#   	Jan Nieuwenhuizen <jan@digicash.com>
# 

MAKE=${MAKE:-make}
PREFIX=${PREFIX:-.}

# this whole script sux, but here we go:
opt="`echo $1 | cut -c 1-3`"
if [ "$opt" = "-h" -o "$opt" = "--h" ]
then
	echo "Usage:"
	echo "	[MAKE=make] configure [options]"
	echo
	echo "options:"
	echo "  -h, --help	this text"
	echo
	echo "e.g.: MAKE=gmake configure"
	exit
fi

#############
#############

do_outdir() {
	if [ \! -d $1/out ]
	then
		touch $1/.GENERATE
		mkdir $1/out
		echo 0 > $1/.build
	fi
}

echo using PREFIX=$PREFIX

do_outdir make
touch make/out/Site.make

$MAKE -C make -f Initial.make

echo "The sources are ready for compiling. "
echo "To make sure that you don't have any stale dependencies: do"
echo "		make clean"

