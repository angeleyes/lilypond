<h1> Packaging instructions</h1>

Please help us by compiling and packing up Lily, and we will link to
your site.


<h2>RedHat</h2>

A spec file is in
<code>make/out/lilypond.redhat.spec</code>. This file is distributed along
with the sources.  You can make the rpm by issuing
<p>
<pre>     
        cp lilypond-x.y.z.tar.gz /usr/src/redhat/SOURCES/
        tar xfz lilypond-x.y.z.tar.gz
     	rpmbuild -bb lilypond-x.y.z/make/out/lilypond.redhat.spec
     </pre>

<p>For compilation on a Red Hat system you need these packages, in
addition to the those needed for running: glibc-devel, gcc-c++,
libstdc++-devel, guile-devel, flex, bison, texinfo, groff, mftrace,
netpbm-progs, autotrace, t1utils.



<h2>Mandrake</h2>

<p>You can also compile a RPM for Mandrake yourself.  A spec file is
in <code>make/out/lilypond.mandrake.spec</code>, see the instructions
for building the Red Hat RPM.</a>


<h2>SuSE</h2>

A spec file is in <code>make/out/lilypond.suse.spec</code>, see the
instructions building the Red Hat RPM.</a>

<p>You must have the following packages: guile tcsh tetex te_latex
te_kpath te_mpost libpng python gpp libgpp gettext autoconf netpbm
libnetpb gs_serv gs_lib gs_fonts guile


<h2>Cygwin</h2>


<h3>Requirements</h3>

   <p>You need the following packages to compile Lilypond on Windows (ie,
for Cygwin).

     <dl>
<dt><code>The GNU + Cygnus tools, 1.3.10 or newer.</code>
     <dd>Check out the <a href="http://cygwin.com">Cygwin webpage</a>. 
You can get the latest version of the GNU + Cygnus tools from a Cygwin
<a href="http://cygwin.com/mirrors.html">mirror site</a>. 
</dl>

<h3>Cross compiling</h4>

<p>Compiling on Windows should be possible, but we never tried.
Share your experiences on lilypond-devel@gnu.org.
 We always use a cross compile:

 Cross compiling for Windows on a GNU/Linux box is done with
mknetrel.  Get it from:
<blockquote>
     <pre>               cvs -d:pserver:anoncvs@sources.redhat.com:/cvs/cygwin-apps co mknetrel
          </pre>
        </blockquote>

<p>Create  a Cygwin cross building
environment, if you don't have it:
Apply the
<a href="http://lilypond.org/cygwin/mknetnel/mknetrel-cross-tools.patch">mknetrel-cross-tools patch</a>, and read <code>CROSS-TOOLS</code>.
<p>
(Although mknetrel is well suited for this, the mknetrel maintainer
does not see any reason to include this patch.)

   <p>You can also get <a
href="http://lilypond.org/lilypond/cygwin/i386-gnu-linux-x-i686-pc-cygwin">precompiled
binaries for GNU/Linux ix68</a>.

<h3>installation specifics</h3>

<p>Installing LilyPond on Windows is similar to a unix installation,
but needs a number of extra tricks.  All code for these tricks can be
found in LilyPond's mknetrel build script in the source package
directory <code>cygwin/mknetrel</code> and <a
href="../../cygwin/mknetrel">mknetrel:extra/lilypond</a>.



<h2>Debian</h2>



<p>If you're real impatient, you may even do:
<pre>     
     	cd lilypond-x.y.z   # a previous version
             uscan               # download and build latest directly from upstream
     </pre>

<p>Debian's TeX installation must have its memory increased:
<pre>     --- texmf.cnf.orig	Sun Dec 16 23:47:07 2001
     +++ texmf.cnf	Sun Dec 16 23:46:34 2001
     @ -411,8 +411,8 @
      main_memory.context = 1500000
      main_memory.mpost = 1000000
      main_memory = 263000 % words of inimemory available; also applies to inimf&amp;mp
     -extra_mem_top = 0    % extra high memory for chars, tokens, etc.
     -extra_mem_bot = 0    % extra low memory for boxes, glue, breakpoints, etc.
     +extra_mem_top = 1000000    % extra high memory for chars, tokens, etc.
     +extra_mem_bot = 1000000    % extra low memory for boxes, glue, breakpoints, etc.
     
      obj_tab_size.context = 300000
     
     @ -430,7 +430,7 @
      % Max number of characters in all strings, including all error messages,
      % help texts, font names, control sequences.  These values apply to TeX and MP.
      pool_size.context = 750000
     -pool_size = 125000
     +pool_size = 250000
      % Minimum pool space after TeX/MP's own strings; must be at least
      % 25000 less than pool_size, but doesn't need to be nearly that large.
      string_vacancies.context = 45000
     </pre>

<p>Another option is
to export <code>extra_mem_top</code> and <code>extra_mem_bot</code> as
environment variables.

   <p>Please contact Anthony Fok <a href="mailto:lilypond@packages.debian.org">lilypond@packages.debian.org</a> for more
information.

   <p>The build scripts are in the subdirectory <code>debian/</code>; you can
make the .deb by doing, for example:

<pre>     	$ su - root
     	# dpkg --purge lilypond lilypond1.3
     	# exit
     	$ tar xzf lilypond-1.4.3.tar.gz
     	$ cd lilypond-1.4.3
     	$ dch -p -v 1.4.3-0.local.1 "Local build."
     	$ debuild
     	$ su - root
     	# dpkg -i ../lilypond_1.4.3*.deb
     	# exit
     	$
     </pre>

   <p>For compilation on a Debian GNU/Linux system you need these packages,
in addition to the those needed for running:

     <ul>
<li>g++, cpp, libc6-dev, libstdc++&lt;<var>your-libstdc++-version-here</var>&gt;-dev
<li>libguile&lt;<var>your-libguile-version-here</var>&gt;-dev
<li>make, m4, flex, bison
<li>gettext
<li>groff, texinfo
<li>tetex-base, tetex-bin, tetex-extra, libkpathsea-dev or tetex-dev
<li>dpkg-dev, debhelper, fakeroot
<li>gs, netpbm
<li>pnmtopng (only in Debian 2.2; pnmtopng has been merged with netpbm
  in Debian testing/unstable.) 
</ul>
