<!--
    Translation of GIT committish: <FILL-IN-HEAD-COMMITTISH>  

    When revising a translation, copy the HEAD committish of the
    version that you are working on.  Refer to `UPDATE A TRANSLATION'
    in README for details.
    !-->

<h1> Localization guidelines</h1>

<p>
  This document provides some guidelines for programmers write user
  messages.

  To help translations, user messages must be uniformized.  Follow these
  rules when coding for LilyPond.

  Hopefully, this can be replaced by general GNU guidelines in the
  future.

  Even better would be to have an English (en_BR, en_AM) helping
  programmers writing consistent messages for all GNU programs.
</p>

<p>
  Not-preferred messages are marked with `+'.  By convention,
  ungrammatical examples are marked with `*'.
</p>
<ul>
  <li>
    Every message to the user should be localised (and thus be marked
    for localisation).  This includes warning and error messages.
  </li>
  <li> Don't localise/gettextify:
    <p>
      - `programming_error ()'s
    </p>
    <p>
      - `programming_warning ()'s
    </p>
    <p>
      - debug strings
    </p>
    <p>
      - output strings (PostScript, TeX, etc.)
    </p>
  </li>
  <li>
    <p>
      Messages to be localised must be encapsulated in `_ (STRING)' or
      `_f (FORMAT, ...)'.  Eg:
    </p>
    <pre>
      warning (_ (&quot;need music in a score&quot;));
      error (_f (&quot;cannot open file: `%s'&quot;, file_name));
    </pre>
    <p>
      In some rare cases you may need to call `gettext ()' by hand.
      This happens when you pre-define (a list of) string constants for
      later use.  In that case, you'll probably also need to mark these
      string constants for translation, using `_i (STRING)'.  The `_i'
      macro is a no-op, it only serves as a marker for `xgettext'.
    </p>
    <pre>
      char const* messages[] = {
      _i ("enable debugging output"),
      _i ("ignore lilypond version"),
      0
      };

    </pre>
    <pre>
      void
      foo (int i)
      {
      puts (gettext (messages <u>i</u>));
      }
    </pre>
    <p>
      See also `flower/getopt-long.cc' and `lily/main.cc'.
    </p>
  </li>
  <li>
    <p>
      Do not use leading or trailing whitespace in messages.  If you need
      whitespace to be printed, prepend or append it to the translated
      message
    </p>
    <pre>
      message (_ ("Calculating line breaks...") + " ");
    </pre>
  </li>
  <li>
    <p>
      Error or warning messages displayed with a file name and line
      number never start with a capital, eg,
      <pre>
	foo.ly: 12: not a duration: 3
      </pre>
      Messages containing a final verb, or a gerund (`-ing'-form) always
      start with a capital.  Other (simpler) messages start with a
      lowercase letter
    </p>
    <pre>
      Processing foo.ly...
      `foo': not declared.
      Not declaring: `foo'.
    </pre>
  </li>
  <li>
    Avoid abbreviations or short forms, use `cannot' and `do not' rather
    than `can't' or `don't'
  </li>
  <li>
    <p>
      To avoid having a number of different messages for the same
      situation, we'll use quoting like this `"message: `%s'"' for all
      strings.  Numbers are not quoted:
    </p>
    <pre>
      _f ("cannot open file: `%s'", name_str)
      _f ("cannot find character number: %d", i)
    </pre>
  </li>
  <li>
    <p>
      Think about translation issues.  In a lot of cases, it is better to
      translate a whole message.  The english grammar mustn't be imposed
      on the translator.  So, instead of
    </p>
    <pre>
      _ ("stem at ") + moment.str () + _ (" does not fit in beam")
    </pre>
    <p>
      have
    </p>
    <pre>
      _f ("stem at %s does not fit in beam", moment.str ())
    </pre>
  </li>
  <li>
    Split up multi-sentence messages, whenever possible.  Instead of
    <pre>
      warning (_f ("out of tune!  Can't find: `%s'", "Key_engraver"));
      warning (_f ("cannot find font `%s', loading default",
      font_name));
    </pre>
    <p>
      rather say:
    </p>
    <pre>
      warning (_ ("out of tune:");
      warning (_f ("cannot find: `%s', "Key_engraver"));
      warning (_f ("cannot find font: `%s', font_name));
      warning (_f ("Loading default font"));
    </pre>
  <li>
    If you must have multiple-sentence messages, use full punctuation.
    <p>
      Use two spaces after end of sentence punctuation.  No punctuation
      (esp. period) is used at the end of simple messages.
    </p>
    <pre>
      _f ("Non-matching braces in text `%s', adding braces", text)
      _ ("Debug output disabled.  Compiled with NPRINT.")
      _f ("Huh?  Not a Request: `%s'.  Ignoring.", request)
    </pre>
  <li>
    <p>
      Do not modularise too much; a lot of words cannot be translated
      without context.  It's probably safe to treat most occurences of
      words like stem, beam, crescendo as separately translatable words.
    </p>
  </li>
  <li>
    <p>
      When translating, it is preferable to put interesting information
      at the end of the message, rather than embedded in the middle.
      This especially applies to frequently used messages, even if this
      would mean sacrificing a bit of eloquency.  This holds for original
      messages too, of course.
    </p>
    <pre>
      en: cannot open: `foo.ly'
      +   nl: kan `foo.ly' niet openen (1)
      kan niet openen: `foo.ly'*   (2)
      niet te openen: `foo.ly'*    (3)

    </pre>
    <p>
      The first nl message, although grammatically and stylistically correct,
      is not friendly for parsing by humans (even if they speak dutch).
      I guess we'd prefer something like (2) or (3).
    </p>
  <li>
     Do not run make po/po-update with GNU gettext &lt; 0.10.35
  </li>
</ul>
