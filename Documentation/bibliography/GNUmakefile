# Documentation/tex/Makefile

depth=../..

OUT_BIB_FILES = $(addprefix $(outdir)/, $(BIB_FILES))
BIB_FILES= $(wildcard *.bib) 

EXTRA_DIST_FILES= $(BIB_FILES) $(wildcard *.bst)


STEPMAKE_TEMPLATES=tex documentation
LOCALSTEPMAKE_TEMPLATES=lilypond ly

include $(depth)/make/stepmake.make 

# urg
default:

GENHTMLS = engraving colorado  computer-notation
OUTGENHTMLS = $(addprefix $(outdir)/, $(GENHTMLS:%=%.html))

local-WWW: $(addprefix $(outdir)/, $(BIB_FILES:.bib=.html))
	$(PYTHON) $(step-bindir)/ls-latex.py  --title 'References on Music Notation' \
	  $(BIB_FILES) $(DOC_FILES) $(TEX_FILES) \
	  | sed "s!$(outdir)/!!g" > $(outdir)/index.html

$(outdir)/%.bib: %.bib
	ln -f $< $@
# we want footers even if website builds (or is built) partly
	$(MAKE) footify

$(outdir)/%.html: %.bib
	$(PYTHON) $(depth)/buildscripts/bib2html.py -o $@ $<
	$(footify) $@

local-clean:
	rm -f fonts.aux fonts.log feta*.tfm feta*.*pk
