@c -*- coding: utf-8; mode: texinfo; -*-
@ignore
    Translation of GIT committish: b9d7f2392b815947674db6c6181e9fb550842fab

    When revising a translation, copy the HEAD committish of the
    version that you are working on.  See TRANSLATION for details.
@end ignore

@c \version "2.11.51"

@node Rhythms
@section Rhythms

@lilypondfile[quote]{rhythms-headword.ly}

Esta sección trata de los ritmos, los silencios, las duraciones, las
barras y los compases.

@menu
* Writing rhythms::             
* Writing rests::               
* Displaying rhythms::          
* Beams::                       
* Bars::                        
* Special rhythmic concerns::   
@end menu


@node Writing rhythms
@subsection Writing rhythms

@menu
* Durations::                   
* Tuplets::                     
* Scaling durations::           
* Ties::                        
@end menu

@node Durations
@subsubsection Durations

@cindex duración de las notas
@cindex notas, duración de

@funindex \longa
@funindex \breve
@funindex \maxima

Las duraciones se designan mediante números y puntos. Las duraciones
se introducen como sus valores recíprocos respecto de la redonda.  Por
ejemplo, una negra se escribe usando un @code{4} (puesto que es 1/4 de
redonda), mientras que una blanca se escribe con un @code{2} (por ser
1/2 de redonda).  Para notas mayores de la redonda se deben usar los
comandos @code{\longa} (que es una breve doble) y @code{\breve}. Se
pueden especificar duraciones tan cortas como la semifusa (con el
número 64).  Son posibles valores más cortos, pero sólo como notas
unidas por una barra.

@c Two 64th notes are needed to obtain beams
@lilypond[quote,ragged-right,verbatim,fragment,relative=2]
\time 8/1
c\longa c\breve c1 c2
c4 c8 c16 c32 c64 c64
@end lilypond

@noindent
Aquí se pueden ver las mismas duraciones con el barrado automático
desactivado.

@c not strictly "writing rhythms"; more of a "displaying" thing,
@c but it's ok here.  -gp
@lilypond[quote,ragged-right,verbatim,fragment,relative=2]
\time 8/1
\autoBeamOff
c\longa c\breve c1 c2
c4 c8 c16 c32 c64 c64
@end lilypond

Se puede escribir una nota con la duración de una cuádruple breve
mediante @code{\maxima}, pero esto está contemplado solamente dentro
de la notación musical antigua.  Para ver más detalles, consulte
@ref{Ancient notation}.

Si la duración se omite, su valor será el de la duración de la nota
anterior.  Por omisión, el valor de la primera nota es el de una
negra.

@lilypond[quote,ragged-right,verbatim,fragment,relative=2]
a a a2 a a4 a a1 a
@end lilypond

@cindex notas, con puntillo
@cindex puntillo, notas con

@funindex .

Para obtener duraciones de notas con puntillo, escriba un punto
(@code{.}) después del número.  Las notas con doble puntillo se
especifican escribiendo dos puntos, y así sucesivamente.

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
a4 b c4. b8 a4. b4.. c8.
@end lilypond

Ciertas duraciones no se pueden representar sólo con duraciones
binarias y puntillos; la única forma de representarlas es ligando dos
o más notas.  Para ver más detalles, consulte @ref{Ties}.

Para ver de qué manera se pueden especificar las duraciones de las
sílabas de la letra y cómo alinear la letra a las notas, consulte
@ref{Vocal music}.

Opcionalmente se pueden espaciar las notas de forma estrictamente
proporcional a sus duraciones.  Para ver más detalles sobre este y
otros ajustes que controlan la notación proporcional, consulte
@ref{Proportional notation}.

@funindex \dotsUp
@funindex \dotsDown
@funindex \dotsNeutral

Normalmente los puntillos se desplazan hacia arriba para evitar las
líneas del pentagrama, excepto en situaciones de polifonía. Para
forzar una dirección concreta de forma manual, véase @ref{Direction
and placement}.


@predefined

@code{\autoBeamOff},
@code{\dotsUp},
@code{\dotsDown},
@code{\dotsNeutral}.


@seealso

Glosario musical:
@rglos{breve}, 
@rglos{longa}, 
@rglos{note value},
@rglos{Duration names notes and rests}.

Referencia de la notación:
@ref{Automatic beams}, 
@ref{Ties},
@ref{Writing rhythms}, 
@ref{Writing rests}, 
@ref{Vocal music},
@ref{Ancient notation}, 
@ref{Proportional notation}.

Fragmentos de código:
@rlsr{Rhythms}.

Referencia de funcionamiento interno:
@rinternals{Dots},
@rinternals{DotColumn}.


@knownissues

@c Deliberately duplicated in Durations and Rests.  -gp
No existe un límite fundamental para las duraciones de los silencios
(tanto para el más largo como para el más corto), pero el numero de
glifos es limitado: sólo se pueden imprimir desde el silencio de
garrapatea (128) hasta el de máxima (8 redondas).


@node Tuplets
@subsubsection Tuplets

@cindex grupos especiales
@cindex tresillos
@funindex \times

Los grupos especiales se obtienen a partir de una expresión musical
multiplicando todas las duraciones por una fracción:

@example
\times @var{fracción} @{ @var{música} @}
@end example

@noindent
La duración de @var{música} se multiplicará por la
fracción.  El denominador de la fracción se imprimirá sobre las notas,
opcionalmente con un corchete.  El grupo especial más común es el
tresillo, en el que 3 notas tienen el valor de 2, por tanto las notas
duran 2/3 de su valor escrito

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
a2 \times 2/3 {b4 b b}
c4 c \times 2/3 {b4 a g}

@end lilypond

@funindex \tupletUp
@funindex \tupletDown
@funindex \tupletNeutral

La colocación automática del corchete de grupo especial por encima o
por debajo de las notas se puede sobreescribir manualmente mediante
instrucciones predefinidas, para ver más detalles consulte
@ref{Direction and placement}.

Los grupos pueden anidarse unos dentro de otros:

@lilypond[quote,fragment,ragged-right,verbatim,relative=2]
\autoBeamOff
c4 \times 4/5 { f8 e f \times 2/3 { e[ f g] } } f4 |
@end lilypond

La modificación de los grupos especiales anidados que comienzan en el
mismo instante musical se debe hacer con @code{\tweak}.

Para modificar la duración de las notas sin imprimir un corchete de
grupo especial, véase @ref{Scaling durations}.

@predefined

@code{\tupletUp},
@code{\tupletDown},
@code{\tupletNeutral}.


@snippets

@cindex tuplet formatting
@cindex triplet formatting

@funindex tupletNumberFormatFunction
@funindex tupletSpannerDuration

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{entering-several-tuplets-using-only-one--times-command.ly}

@funindex TupletNumber

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{changing-the-tuplet-number.ly}

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{permitting-line-breaks-within-beamed-tuplets.ly}

@seealso

Glosario musical:
@rglos{triplet},
@rglos{tuplet},
@rglos{polymetric}.

Manual de aprendizaje:
@rlearning{Tweaking methods}.

Referencia de la notación:
@ref{Time administration},
@ref{Scaling durations},
@ref{Objects connected to the input},
@ref{Polymetric notation}.

Fragmentos de código:
@rlsr{Rhythms}.

Referencia de funcionamiento interno:
@rinternals{TupletBracket},
@rinternals{TupletNumber},
@rinternals{TimeScaledMusic}.

@knownissues
@cindex adorno, notas de, dentro de corchetes de grupo especial
Cuando la primera nota de un pentagrama es una nota de adorno (un
mordente de una nota) seguida de un grupo de valoración especial, la
nota de adorno se debe situar antes de la instrucción @code{\times}
para evitar errores.  En cualquier otro lugar, las notas de adorno sí
se pueden colocar dentro de los corchetes de grupo especial.


@node Scaling durations
@subsubsection Scaling durations

@cindex scaling durations
@cindex durations, scaling

Es posible alterar la duración de las figuras, silencios o acordes en
un factor @code{N/M} añadiendo @code{*N/M} (o @code{*N} si @code{M} es
1) a la duración.  Esto no afectará a la apariencia de las notas o
silencios que se producen, pero la duración alterada se usará para
calcular la posición dentro del compás y para establecer la duración
en la salida MIDI.  Los factores de multiplicación se pueden combinar
en la forma @code{*L*M/N}.

En el siguiente ejemplo las tres primeras notas duran exactamente dos
partes, pero no se imprime ningún corchete de tresillo.

@lilypond[quote,ragged-right,fragment,relative=2,verbatim]
\time 2/4
% Alter durations to triplets
a4*2/3 gis4*2/3 a4*2/3
% Normal durations
a4 a4
% Double the duration of chord
<a d>4*2
% Duration of quarter, appears like sixteeth
b16*4 c4
@end lilypond

La duración de las notas de salto o espaciadoras también se puede
modificar mediante un multiplicador.  Esto es útil para saltar muchos
compases, como por ejemplo @code{s1*23}.

@cindex compresión de música
@funindex \scaleDurations

De la misma forma, se pueden comprimir por una fracción trozos de
música más largos, como si cada nota, acorde o silencio tuviera la
fracción como multiplicador.  La sintaxis general de la iinstrucción
que lo hace es:

@example
\scaleDurations #'(@emph{numerador} . @emph{denominador}) @{ @emph{música} @}
@end example

@noindent
Esto dejará intacta la apariencia de la @emph{música}, pero la
duración interna de las notas se multiplicará por la fracción
@emph{numerador}/@emph{denominador}.  Los espacios que rodean el punto
son necesarios.  He aquí un ejemplo que muestra cómo se puede
comprimir y expandir la música:

@lilypond[quote,fragment,relative=2,ragged-right,verbatim]
\time 2/4
% Normal durations
<c a>4 c8 a
% Scale music by *2/3
\scaleDurations #'(2 . 3) {
  <c a f>4. c8 a f
}
% Scale music by *2
\scaleDurations #'(2 . 1) {
  <c' a>4 c8 b
}
@end lilypond

@noindent
Una aplicación de esta instrucción se encuentra en la notación
polimétrica, véase @ref{Polymetric notation}.


@seealso

Referencia de la notación:
@ref{Tuplets},
@ref{Skips},
@ref{Polymetric notation}.

Fragmentos de código:
@rlsr{Rhythms}.



@node Ties
@subsubsection Ties

@cindex ligadura de unión
@funindex ~

Una ligadura de unión conecta dos notas adyacentes de la misma altura.  La ligadura
en efecto extiende la longitud de una nota.

@warning{No deben confundirse las ligaduras de unión con las
@emph{ligaduras de expresión}, que indican articulación, ni con las
@emph{ligaduras de fraseo}, que indican el fraseo musical.  Una
ligadura de unión es tan sólo una manera de extender la duración de
una nota, algo parecido a lo que hace el puntillo.}

Se introduce una ligadura de unión usando el símbolo de la tilde curva
@code{~}

@lilypond[quote,ragged-right,fragment,verbatim]
e' ~ e'
@end lilypond

@noindent
Se usan ligaduras de unión bien cuando la nota atraviesa la barra de
compás o bien cuando no se pueden usar puntillos para denotar el
ritmo.  También se deben usar ligaduras cuando las notas atraviesan
subdivisiones del compás de mayor duración:

@c KEEP LY
@lilypond[fragment,quote,ragged-right]
\relative {
  r8^"sí" c8 ~ c2 r4 | r8^"no" c2 ~ c8 r4
}
@end lilypond

Si necesita ligar muchas notas a través de las líneas divisorias,
podría resultarle más fácil utilizar la división automática de las
notas, véase @ref{Automatic note splitting}.  Este mecanismo divide
automáticamente las notas largas y las liga a través de las barras de
compás.

@cindex ties and chords
@cindex chords and ties

Cuando se aplica una ligadura de unión a un acorde, se conectan todas
las cabezas de las notas cuyas alturas coinciden.  Si no coincide
ningún par de cabezas, no se crea ninguna ligadura.  Los acordes se
pueden ligar parcialmente colocando la ligadura dentro del acorde.

@lilypond[quote,ragged-right,fragment,verbatim,relative=1]
 <c e g> ~ <c e g>
<c~ e g~ b> <c e g b>
@end lilypond

@funindex \repeatTie
@cindex repetición, ligaduras de unión en
@cindex ligaduras de unión, repeticiones y
@cindex primera y segunda vez, corchetes y ligaduras en
@cindex ligaduras de unión y corchetes de primera y segunda vez

Cuando la segunda vez de una repetición comienza con una nota ligada,
es necesario especificar la ligadura repetida como sigue:

@lilypond[fragment,quote,ragged-right,relative=2,verbatim]
\repeat volta 2 { c g <c e>2 ~ }
\alternative {
  % First alternative: following note is tied normally
  { <c e>2. r4 }
  % Second alternative: following note has a repeated tie
  {<c e>2\repeatTie d4 c }}
@end lilypond

@cindex laissez vibrer
@cindex ligaduras laissez vibrer
@funindex \laissezVibrer

Las ligaduras @notation{L.v.} (@notation{laissez vibrer}, dejar
vibrar) indican que las notas no se deben apagar al final.  Se usan en
la notación para piano, arpa y otros instrumentos de cuerda y
percusión.  Se pueden introducir de la siguiente manera:

@lilypond[fragment,ragged-right,verbatim,relative=1]
<c f g>\laissezVibrer
@end lilypond


@cindex ligaduras, colocación
@funindex \tieUp
@funindex \tieDown
@funindex \tieNeutral

Es posible controlar la colocación vertical de las ligaduras de unión;
véase la sección de instrucciones predefinidas, o para ver más
detalles, consulte @ref{Direction and placement}.


@cindex ligaduras, apariencia
@funindex \tieDotted
@funindex \tieDashed
@funindex \tieSolid

Se pueden especificar ligaduras continuas, de puuntos o intermitentes,
véase la sección de instrucciones predefinidas.

@predefined

@code{\tieUp},
@code{\tieDown},
@code{\tieNeutral},
@code{\tieDotted},
@code{\tieDashed},
@code{\tieSolid},
@code{\repeatTie}.


@snippets

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{using-ties-with-arpeggios.ly}

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{engraving-ties-manually.ly}

@seealso

Glosario musical:
@rglos{tie},
@rglos{laissez vibrer}.

Referencia de la notación:
@ref{Automatic note splitting}.

Fragmentos de código:
@rlsr{Rhythms}.

Referencia de funcionamiento interno:
@rinternals{LaissezVibrerTie},
@rinternals{LaissezVibrerTieColumn},
@rinternals{TieColumn},
@rinternals{Tie}.


@knownissues


Un cambio de pentagrama cuando hay una ligadura activa no producirá
una ligadura inclinada.

Los cambios de clave o de octava durante una ligadura de unión no
están bien definidos realmente.  En estos casos puede ser preferible
una ligadura de expresión.




@node Writing rests
@subsection Writing rests

@menu
* Rests::                       
* Skips::                       
* Full measure rests::          
@end menu

@node Rests
@subsubsection Rests
@cindex Silencios

@funindex \rest
@funindex r

Los silencios se introducen como notas con el nombre @code{r}

@lilypond[fragment,quote,ragged-right,verbatim]
r1 r2 r4 r8
@end lilypond

Los silencios de un compás centrados en medio del compás,
se deben hacer con silencios multicompás.  Se pueden usar para 
un solo compás así como para muchos compases, y se tratan en
@ref{Full measure rests}.

Para especificar explícitamente la posición vertical de un silencio, escriba una nota
seguida de @code{\rest}.  Se colocará un silencio en la posición en que debería
aparecer la nota:

@lilypond[fragment,quote,ragged-right,verbatim]
a'4\rest d'4\rest
@end lilypond

@noindent
Esto hace mucho más sencillo el formateo de
la música polifónica,
porque el formateador automático de colisiones de silencios se olvidará de ellos.

@snippets

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{rest-styles.ly}


@seealso

Referencia de la notación:
@ref{Full measure rests}.

Fragmentos de código:
@rlsr{Rhythms}.

Referencia de funcionamiento interno:
@rinternals{Rest}.


@knownissues

@c Deliberately duplicated in Durations and Rests.  -gp
No existe un límite fundamental respecto de las duraciones de los
silencios (tanto para el más corto como para el más largo), pero el
número de glifos es limitado: hay silencios desde la garrapatea (128)
hasta la máxima (8 redondas).


@node Skips
@subsubsection Skips

@cindex Desplazamiento
@cindex Silencio invisible
@cindex Nota de espaciado
@funindex \skip
@funindex s

Un silencio invisible -- también conocido como @q{skip} (desplazamiento) --
se puede introducir como una nota con el nombre @code{s} o con @code{\skip @var{duración}}

@lilypond[fragment,quote,ragged-right,verbatim,relative=2]
a4 a4 s4 a4 \skip 1 a4
@end lilypond

La sintaxis de @code{s} sólo está disponible en el modo de notas y en el modo de acordes.
En otras situaciones, por ejemplo, cuando se introduce la letra, debe
usar el comando @code{\skip}

@lilypond[quote,ragged-right,verbatim]
<<
  \relative { a'2 a2 }
  \new Lyrics \lyricmode { \skip 2 bla2 }
>>
@end lilypond

El comando skip es un mero contenedor musical vacío.  No produce
ninguna salida, ni siguiera una salida transparente.

El comando de desplazamiento @code{s} crea una @rinternals{Staff} y una
@rinternals{Voice} cuando es necesario, de forma similar a los comandos de nota y de silencio.
Por ejemplo, el fragmento siguiente produce un pentagrama vacío.

@lilypond[quote,ragged-right,verbatim]
{ s4 }
@end lilypond

El fragmento @code{@{ \skip 4 @} } produciría una página vacía.

@seealso

Referencia de funcionamiento interno:
@rinternals{SkipMusic}.


@node Full measure rests
@subsubsection Full measure rests

@cindex multicompás, silencios
@cindex compás completo, silencios de
@cindex Silencios multicompás
@cindex Silencios de compás completo
@cindex redonda, silencios de, para un compás completo
@funindex R

Los silencios de un compás completo (o muchos compases) se escriben como @code{R}.  Esto está
indicado específicamente para silencios de compás completo y para escribir particellas: el silencio
se puede expandir de forma que rellene una partitura con silencios, o se puede imprimir como un solo silencio multicompás.
Esta expansión se controla por medio de la propiedad
@code{Score.skipBars}.  Si está establecido al valor true, los compases vacíos no se
expandirán, y se añadirá automáticamente el número correspondiente

@lilypond[quote,ragged-right,fragment,verbatim]
\time 4/4 r1 | R1 | R1*2 \time 3/4 R2. \time 2/4 R2 \time 4/4
\set Score.skipBars = ##t R1*17 R1*4
@end lilypond

El número @code{1} de @code{R1} es similar a la notación de la duración que se usa para las
notas.  De aquí que para indicaciones de compás distintas al 4/4, tengamos que escribir
otras duraciones.  Esto se puede hacer con puntillos de prolongación o con fracciones

@lilypond[quote,ragged-right,fragment,verbatim]
\set Score.skipBars = ##t
\time 3/4
R2. | R2.*2
\time 13/8
R1*13/8
R1*13/8*12 |
\time 10/8 R4*5*4 |
@end lilypond

Una @code{R} que dura un solo compás se imprime como un silencio de redonda o breve,
centrado en el compás independientemente de la indicación de compás.

Si hay sólo algunos compases de silencio, LilyPond imprime @q{silencios eclesiásticos}
(un conjunto de pequeños rectángulos) en el pentagrama.  Para sustituirlos con silencios ordinarios,
utilice @code{MultiMeasureRest.expand-limit}.

@lilypond[quote,ragged-right,fragment,verbatim]
\set Score.skipBars = ##t
R1*2 | R1*5 | R1*9
\override MultiMeasureRest #'expand-limit = 1
R1*2 | R1*5 | R1*9
@end lilypond

@cindex texto sobre silencios multicompás
@cindex textual, inscripción, sobre silencios multicompás
@cindex calderón sobre silencios multicompás

Se pueden añadir textos a los silencios multicompás utilizando la sintaxis
@var{nota}-@code{marca} de @ref{Formatting text}.
Hay una variable (@code{\fermataMarkup}) para añadir
calderones

@lilypond[quote,ragged-right,verbatim,fragment]
\set Score.skipBars = ##t
\time 3/4
R2.*10^\markup { \italic "ad lib." }
R2.^\fermataMarkup
@end lilypond

¡Advertencia!  Este texto se crea por parte de @code{MultiMeasureRestText}, no de
@code{TextScript}.

@lilypond[quote,ragged-right,verbatim,fragment]
\override TextScript #'padding = #5
R1^"low"
\override MultiMeasureRestText #'padding = #5
R1^"high"
@end lilypond

Si queremos poner texto a la izquierda de un silencio multicompás,
adjuntamos el texto a una nota de salto de longitud cero, esto es

@example
s1*0^"Allegro"
R1*4
@end example

@snippets

@cindex eclesiásticos, silencios
@cindex silencios eclesiásticos
@cindex kirchenpausen

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{changing-form-of-multi--measure-rests.ly}

@cindex multicompás, posicionamiento de los silencios
@cindex colocación de los silencios multicompás

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{positioning-multi--measure-rests.ly}


@seealso

Referencia de funcionamiento interno:
@rinternals{MultiMeasureRestMusicGroup},
@rinternals{MultiMeasureRest}.

El objeto de presentación @rinternals{MultiMeasureRestNumber} es para
el número por defecto, y @rinternals{MultiMeasureRestText} para los
textos definidos por el usuario.


@knownissues

No se pueden usar digitaciones (p.ej. @code{R1-4}) para poner números
encima de los silencios multicompás.  Y la altura de los silencios
multicompás (o silencios centrados en el pentagrama) no se puede
modificar.

@cindex silencios condensados

No hay ninguna forma de condensar automáticamente muchos silencios en
un solo silencio multicompás.  Los silencios multicompás no toman
parte en las comprobaciones de colisión de silencios.

Tenga cuidado al escribir silencios multicompás seguidos por redondas.
El código siguiente introduce dos notas que tienen una duración de
cuatro compases cada una
@example
R1*4 cis cis
@end example
Cuando @code{skipBars} esté establecido, el aspecto del resultado será
correcto, pero la numeración de los compases estará desactivada.


@node Displaying rhythms
@subsection Displaying rhythms

@menu
* Time signature::              
* Upbeats::                     
* Unmetered music::             
* Polymetric notation::         
* Automatic note splitting::    
* Showing melody rhythms::      
@end menu

@node Time signature
@subsubsection Time signature

@cindex Indicación de compás
@cindex metro, medida
@funindex \time

La indicación de compás indica el metro de la pieza: su patrón regular
de partes fuertes y débiles.  Se denota por una fracción al comienzo
del pentagrama.

La indicación de compás se establece mediante el comando @code{\time}

@lilypond[quote,ragged-right,fragment,verbatim]
\time 2/4 c'2 \time 3/4 c'2.
@end lilypond

@commonprop

Se puede personalizar el símbolo que se imprime mediante la propiedad
@code{style}.  Un valor de @code{#'()} produce un estilo de fracción
para los compases de 4/4 y de 2/2,

@lilypond[fragment,quote,ragged-right,verbatim]
\time 4/4 c'1
\time 2/2 c'1
\override Staff.TimeSignature #'style = #'()
\time 4/4 c'1
\time 2/2 c'1
@end lilypond

Existen otras muchas opciones para su presentación.  Para ver más
ejemplos, consulte @ref{Ancient time signatures}.

@code{\time} establece las propiedades @code{timeSignatureFraction},
@code{beatLength} y @code{measureLength} en el contexto @code{Timing},
cuyo nombre alternativo normalmente es @rinternals{Score}.  La
propiedad @code{measureLength} determina el lugar en que se deben
insertar las barras de compás y cómo se generan las barras de corchea
automáticas.  La modificación del valor de
@code{timeSignatureFraction} también provoca que se imprima el
símbolo.

Están disponibles más opciones a través de la función de Scheme
@code{set-time-signature}.  En combinación con el grabador
@rinternals{Measure_grouping_engraver} (agrupación de compases),
creará signos de @rinternals{MeasureGrouping}.  Estos signos facilitan
la lectura de música moderna rítmicamente compleja.  En el siguiente
ejemplo el compás de 9/8 se subdivide en 2, 2, 2 y 3.  Esto se pasa a
@code{set-time-signature} como un tercer argumento con el valor
@code{(2 2 2 3)}

@lilypond[quote,ragged-right,verbatim]
\score {
  \relative c'' {
    #(set-time-signature 9 8 '(2 2 2 3))
    g8[ g] d[ d] g[ g] a8[( bes g]) |
    #(set-time-signature 5 8 '(3 2))
    a4. g4
  }
  \layout {
    \context {
      \Staff
      \consists "Measure_grouping_engraver"
    }
  }
}
@end lilypond


@snippets

@cindex compuesto, indicaciones de compás
@cindex compás compuesto, indicaciones de

@lilypondfile[verbatim,lilyquote,ragged-right,texidoc,doctitle]
{compound-time-signatures.ly}

@seealso

Referencia de funcionamiento interno:
@rinternals{TimeSignature},
@rinternals{Timing_translator}.

Ejemplos:
@rlsr{Rhythms}.


@knownissues

El barrado automático no utiliza la agrupación de compases
especificada con @code{set-time-signature}.


@node Upbeats
@subsubsection Upbeats

@cindex anacrusa
@cindex parte al alzar
@cindex compás parcial
@cindex parcial, compás
@cindex acortar compases
@funindex \partial

Los compases parciales como las anacrusas o partes al alzar se
escriben usando la construcción

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
\partial 16*5 c16 cis d dis e | a2. c,4 | b2
@end lilypond

La sintaxis de este comando es la siguiente:

@example
\partial @var{duración}
@end example

donde @code{duración} es el valor rítmico que se se debe añadir antes
del siguiente compás.

Esto se traduce internamente a

@example
\set Timing.measurePosition = -@var{longitud de la duración}
@end example

La propiedad @code{measurePosition} contiene un número racional que
indica qué parte del compás ha transcurrido hasta el momento.  Observe
que es un número negativo; @code{\partial 4} se traduce internamente
con el significado de @qq{queda un valor de negra en este compás}.


@knownissues

Este comando no tiene en cuenta las notas de adorno al comienzo de la
música.  Cuando una pieza comienza con notas de adorno en la anacrusa,
el @code{\partial} debe escribirse después de las notas de adorno

@lilypond[verbatim,quote,ragged-right,relative,fragment]
\grace f16
\partial 4
g4
a2 g2
@end lilypond

El uso de @code{\partial} está previsto solamente para el comienzo de
una pieza.  Si se emplea después del comienzo se obtendrán varias
advertencias desagradables.


@node Unmetered music
@subsubsection Unmetered music

@cindex cadencia
@funindex \cadenzaOn
@funindex \cadenzaOff

Las líneas divisorias y los números de compás se calculan
automáticamente.  Para música sin compasear (por ejemplo cadencias),
esto no es deseable.  Para desactivar las barras y los números de
compás automáticos, utilice los comandos @code{\cadenzaOn} y
@code{\cadenzaOff}.

@lilypond[verbatim,quote,ragged-right,relative=2,fragment]
c4 d e d
\cadenzaOn
c4 c d8 d d f4 g4.
\cadenzaOff
\bar "|"
d4 e d c
@end lilypond


@knownissues

LilyPond insertará saltos de línea y de página solamente en las barras
de compás.  A menos que la música sin compasear acabe antes del final
de la línea del pentagrama, tendrá que insertar barras de compás
invisibles

@example
\bar ""
@end example

@noindent
para indicar dónde se pueden producir los saltos.


@node Polymetric notation
@subsubsection Polymetric notation

UNTRANSLATED NODE: IGNORE ME


@node Automatic note splitting
@subsubsection Automatic note splitting

Las notas largas se pueden convertir automáticamente en notas ligadas.
Se hace mediante la sustitución del @rinternals{Note_heads_engraver}
por el @rinternals{Completion_heads_engraver}.  En los siguientes
ejemplos, las notas que atraviesan la barra de compás se dividen y se
unen mediante una ligadura.

@lilypond[quote,fragment,verbatim,relative=1,line-width=12\cm]
\new Voice \with {
  \remove "Note_heads_engraver"
  \consists "Completion_heads_engraver"
} {
  c2. c8 d4 e f g a b c8 c2 b4 a g16 f4 e d c8. c2
}
@end lilypond

Este grabador divide todas las notas largas en la barra de compás e
inserta ligaduras.  Uno de sus usos es depurar partituras complejas:
si los compases no están completos, las ligaduras mostrarán
exactamente cuánto le falta a cada compás.

Si quiere permitir el salto de línea en las barras de compás en las
que @rinternals{Completion_heads_engraver} divide las notas, debe
eliminar también @rinternals{Forbid_line_break_engraver}.


@knownissues

No todas las duraciones (sobre todo las que contienen grupos
especiales) se pueden representar exactamente con notas normales y
puntillos, pero el grabador nunca insertará grupos especiales.

@code{Completion_heads_engraver} afecta sólo a las notas; no divide
silencios.


@seealso

Referencia de funcionamiento interno:
@rinternals{Completion_heads_engraver}.

@node Showing melody rhythms
@subsubsection Showing melody rhythms

A veces podemos querer mostrar solamente el ritmo de una melodía.
Esto se puede hacer con un pentagrama de ritmo.  Todas las alturas de
las notas se convierten en barras inclinadas, y el pentagrama tiene
una sola línea:

@c TODO Devise a more realistic example, perhaps with lyrics -td
@lilypond[quote,ragged-right,fragment,relative=1,verbatim]
\new RhythmicStaff {
  \time 4/4
  c4 e8 f g2 | r4 g r2 | g1 | r1 |
}
@end lilypond

@node Beams
@subsection Beams

@menu
* Automatic beams::             
* Setting automatic beam behavior::  
* Manual beams::                
* Feathered beams::             
@end menu

@node Automatic beams
@subsubsection Automatic beams

De manera predeterminada, las barras de corchea se insertan
automáticamente:

@cindex barras manuales
@cindex manuales, barras

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
\time 2/4 c8 c c c
\time 6/8 c c c c8. c16 c8
@end lilypond

Cuando estas decisiones automáticas no son lo bastante buenas, se
pueden escribir los barrados de forma explícita; véase @ref{Manual
beams}.  También es posible definir patrones de barrado que difieran
de los ajustes por defecto; véase @ref{Setting automatic beam
behavior}.  Las reglas de barrado predeterminadas están definidas en
el archivo @file{scm/@/auto@/-beam@/.scm}.

@cindex autoBeamOn
@cindex autoBeamOff

@noindent
El barrado automático se puede habilitar o desactivar con las
instrucciones @code{\autoBeamOff} y @code{\autoBeamOn}:

@lilypond[quote,ragged-right,fragment,relative=1,verbatim]
c4 c8 c8. c16 c8. c16 c8
\autoBeamOff
c4 c8 c8. c16 c8.
\autoBeamOn
c16 c8
@end lilypond


@snippets

Los patrones de barrado se pueden alterar con la propiedad
@code{beatGrouping}:

@lilypond[quote,verbatim,relative=2,fragment,ragged-right]
\time 5/16
\set beatGrouping = #'(2 3)
c8[^"(2+3)" c16 c8]
\set beatGrouping = #'(3 2)
c8[^"(3+2)" c16 c8]
@end lilypond

De forma predeterminada, las barras de semicorchea o notas más cortas
no se subdividen.  Esto es, el grupo de tres o más barras se amplía
sin romperse sobre grupos enteros de notas.  Este comportamiento se
puede modificar para que se subdividan las barras en subgrupos
ajustando la propiedad @code{subdivideBeams}.  Cuando está estblecida,
varias barras se verán subdivididas a intervalos definidos por el
valor actual @code{beatLength} reduciendo las barras múltiples a una
sola entre los subgrupos.  Observe que @code{beatLength} reside dentro
del contexto de @code{Score} y tiene un valor predeterminado de negra.
Se debe ajustar para que sea una fracción que dé como resultado la
duración del subgrupo de barras usando la función @code{make-moment},
como se muestra aquí:

@lilypond[fragment,ragged-right,quote,relative=2,verbatim]
c32[ c c c c c c c]
\set subdivideBeams = ##t
c32[ c c c c c c c]
% Set beam sub-group length to an eighth note
\set Score.beatLength = #(ly:make-moment 1 8)
c32[ c c c c c c c]
% Set beam sub-group length to a sixteenth note
\set Score.beatLength = #(ly:make-moment 1 16)
c32[ c c c c c c c]
@end lilypond
@funindex subdivideBeams

@noindent
Para más información sobre @code{make-moment}, véase @ref{Time
administration}.

@funindex divisible
@cindex salto de línea
@cindex línea, saltos de

Normalmente están prohibidos los saltos de línea cuando las barras
atraviesan a la línea divisoria.  Este comportamiento se puede
modificar ajustando la propiedad @code{breakable}:
@code{\override Beam #'breakable = ##t}.

@lilypond[ragged-right,relative=2,fragment,verbatim,quote]
\override Beam #'breakable = ##t
c8 \repeat unfold 15 { c[ c] } c
@end lilypond

@cindex barras y saltos de línea
@cindex barras en ángulo
@cindex dobladas, barras
@cindex auto-knee-gap

Cuando se detecta un salto muy grande entre las cabezas de las notas,
se inserta automáticamente una barra doblada o en ángulo.  Este
comportamiento se puede afinar a través de la propiedad
@code{auto-knee-gap}.  Se dibuja una barra doblada si el salto es
mayor que el valor de @code{auto-knee-gap} más el ancho del propio
objeto barra (que depende de la duración de las notas y la inclinación
de la barra).  De forma predeterminada @code{auto-knee-gap} está
establecido al valor de 5.5 espacios de pentagrama.

@lilypond[fragment,ragged-right,quote,verbatim]
f8 f''8 f8 f''8
\override Beam #'auto-knee-gap = #6
f8 f''8 f8 f''8
@end lilypond


@seealso

Referencia de la notación:
@ref{Manual beams},
@ref{Setting automatic beam behavior}.

Fragmentos de código:
@rlsr{Rhythms}.

Referencia de funcionamiento interno:
@rinternals{Beam}.


@knownissues

No se pueden usar conjuntamente barras dobladas automáticamente que
cruzan pentagramas y pentagramas ocultos.  Véase @ref{Hiding staves}.

Las barras pueden colisionar con las cabezas de las notas y las
alteraciones accidentales de las otras voces.

@node Setting automatic beam behavior
@subsubsection Setting automatic beam behavior

@funindex autoBeamSettings
@funindex (end * * * *)
@funindex (begin * * * *)
@cindex barras automáticas, ajuste fino
@cindex ajuste fino de las barras automáticas

@c [TODO: use \applyContext]

En compases de tipo normal, las barras automáticas pueden comenzar en
cualquier nota pero solamente pueden terminar en algunas poriciones
dentro del compás: las barras pueden terminar sobre una parte, o sobre
duraciones que estén especificadas por las propiedades de
@code{autoBeamSettings}.  Las propiedades de @code{autoBeamSettings}
consisten en un a lista de reglas que especifican dónde pueden
comenzar y teminar las barras.  Las reglas predeterminadas de
@code{autoBeamSettings} están definidas en
@file{scm/@/auto@/-beam@/.scm}.

Para poder añadir una regla a la lista, utilice
@example
#(override-auto-beam-setting '(be p q n m) a b [contexto])
@end example

@itemize

@item @code{be} es @code{begin} o bien @code{end}.

@item @code{p/q} es la duración de la nota para la que quiere añadir una
regla.  Se considera que una barra tiene la duración de su nota más
breve.  Ajuste @code{p} y @code{q} a @code{'*'} para que esto se
aplique a cualquier barra.

@item @code{n/m} es la indicación de compás al que se aplica esta regla.
Ajuste @code{n} y @code{m} a @code{'*'} para hacer que se aplique a
cualquier tipo de compás.

@item @code{a/b} es la posición dentro del compás en que la barra debe
comenzar o acabar.

@item @code{contexto} es opcional, y especifica el contexto en que se debe
hacer el cambio.  El valor predeterminado es @code{'Voice}.

@code{#(score-override-auto-beam-setting '(A B C D) E F)} es
equivalente a @code{#(override-auto-beam-setting '(A B C D) E F
'Score)}.

@end itemize

Por ejemplo, si las barras automáticas siempre debe terminar sobre la
primera negra, use

@example
#(override-auto-beam-setting '(end * * * *) 1 4)
@end example

Podemos forzar los ajustes de las barras para que sólo tengan efecto
sobre barras cuya nota más breve es una cierta duración:

@lilypond[quote,fragment,ragged-right,verbatim,relative=2]
\time 2/4
#(override-auto-beam-setting '(end 1 16 * *) 1 16)
a16 a a a a a a a |
a32 a a a a16 a a a a a |
#(override-auto-beam-setting '(end 1 32 * *) 1 16)
a32 a a a a16 a a a a a |
@end lilypond

Podemos forzar los ajustes de las barras para que sólo tengan efecto
en ciertos tipos de compás:

@lilypond[quote,fragment,ragged-right,verbatim,relative=2]
\time 5/8
#(override-auto-beam-setting '(end * * 5 8) 2 8)
c8 c d d d
\time 4/4
e8 e f f e e d d
\time 5/8
c8 c d d d
@end lilypond

También podemos eliminar una regla de fin de barrado previamente
establecida usando

@example
#(revert-auto-beam-setting '(be p q n m) a b [contexto])
@end example

@noindent
@code{be}, @code{p}, @code{q}, @code{n}, @code{m}, @code{a}, @code{b}
y @code{context} son los mismos que antes.  Observe que las reglas
predeteminadas se especifican en @file{scm/@/auto@/-beam@/.scm}, así
que podemos revertir las reglas que no hayamos creado explícitamente.

@lilypond[quote,fragment,ragged-right,verbatim,relative=2]
\time 4/4
a16 a a a a a a a a a a a a a a a
#(revert-auto-beam-setting '(end 1 16 4 4) 1 4)
a16 a a a a a a a a a a a a a a a
@end lilypond

La regla de un enunciado @code{revert-auto-beam-setting} debe
corresponderse exactamente con la regla original.  Esto es, no se
tiene en cuenta ninguna expansión de comodines.

@lilypond[quote,fragment,ragged-right,verbatim,relative=2]
\time 1/4
#(override-auto-beam-setting '(end 1 16 1 4) 1 8)
a16 a a a
#(revert-auto-beam-setting '(end 1 16 * *) 1 8) % this won't revert it!
a a a a
#(revert-auto-beam-setting '(end 1 16 1 4) 1 8) % this will
a a a a
@end lilypond



@c TODO:  old material -- not covered by above stuff, I think.
Si las barras automáticas han de terminar en cada negra de un compás
de 5/4 time, especifique todas las terminaciones
@example
#(override-auto-beam-setting '(end * * * *) 1 4 'Staff)
#(override-auto-beam-setting '(end * * * *) 1 2 'Staff)
#(override-auto-beam-setting '(end * * * *) 3 4 'Staff)
#(override-auto-beam-setting '(end * * * *) 5 4 'Staff)
@dots{}
@end example

Se puede usar la misma sintaxis para especificar los puntos de inicio
de las barras.  En este ejemplo, las barras automáticas sólo pueden
terminar sobre una negra con puntillo:
@example
#(override-auto-beam-setting '(end * * * *) 3 8)
#(override-auto-beam-setting '(end * * * *) 1 2)
#(override-auto-beam-setting '(end * * * *) 7 8)
@end example
En el compás de 4/4, esto significa que las barras automáticas sólo
pueden terminar sobre 3/8 y sobre el cuarto pulso del compás (después
de que 3/4, esto es, 2 veces 3/8, han transcurrido del compás).

Si se produce cualquier comportamiento inesperado de las barras,
compruebe los ajustes de barrado automático predeterminados que están
en @file{scm/@/auto@/-beam@/.scm} en busca de una posible
interferencia, porque los finales de barra que están allí definidos
aún se aplicarán encima de sus propias sobreescrituras.  Cualquier
final no deseado en los valores predeterminados se debe revertir para
nuestro compás concreto.

Por ejemplo, para tipografiar finales de barra de @code{(3 4 3 2)} en
un 12/8, comience por

@example
%%% revertir los valores predeterminados de scm/auto-beam.scm repecto al compás de 12/8
#(revert-auto-beam-setting '(end * * 12 8) 3 8)
#(revert-auto-beam-setting '(end * * 12 8) 3 4)
#(revert-auto-beam-setting '(end * * 12 8) 9 8)

%%% sus nuevos valores
#(override-auto-beam-setting '(end 1 8 12 8) 3 8)
#(override-auto-beam-setting '(end 1 8 12 8) 7 8)
#(override-auto-beam-setting '(end 1 8 12 8) 10 8)
@end example

@cindex automática, generación de barras
@cindex auto-barrado
@funindex autoBeaming
@cindex letra

Si se usan barras para indicar melismas en canciones, entonces el
barrado automático se debe inhabilitar con @code{\autoBeamOff}.


@predefined

@funindex \autoBeamOff
@code{\autoBeamOff},
@funindex \autoBeamOn
@code{\autoBeamOn}.


@knownissues

Si una partitura termina mientras una barra automática no ha terminado
aún todavía está aceptando notas, esta última barra no se imprimirá en
absoluto.  Lo mismo sirve para las voces polifónicas, introducidas con
@code{<< @dots{} \\ @dots{} >>}.  Si una voz polifónica termina
mientras una barra automática está aún aceptando notas, no se imprime.

@seealso

Fragmentos de código:
@rlsr{Rhythms}.


@node Manual beams
@subsubsection Manual beams

@cindex barras manuales
@funindex ]
@funindex [

En ciertos casos puede ser preciso sobreescribir el algoritmo de
barrado automático.  Por ejemplo, el barrador automático no escribe
barras por encima de los silencios o las líneas divisorias, y en las
partituras corales el barrado se ajusta con frecuencia para que siga
la medida de la letra en vez de la de las notas.  Tales barras se
especifican manualmente marcando los puntos de comienzo y final con
@code{[} y @code{]}

@lilypond[quote,ragged-right,fragment,relative=1,verbatim]
{
  r4 r8[ g' a r8] r8 g[ | a] r8
}
@end lilypond


Se pueden marcar notas individuales con @code{\noBeam} para evitar que
resulten unidas por una barra:

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
\time 2/4 c8 c\noBeam c c
@end lilypond

@funindex ]
@funindex [

@funindex stemLeftBeamCount
@funindex stemRightBeamCount

Se puede conseguir un control incluso más estritcto sobre las barras
estableciendo las propiedades @code{stemLeftBeamCount} y
@code{stemRightBeamCount}.  Especifican el número de barras que se
dibujarán en los lados izquierdo y derecho, respectivamente, de la
nota siguiente.  Si cualquiera de estas dos propiedades está ajustada
a un valor, dicho valor se usará una sola vez, y luego se borrará.  En
este ejemplo, el último Fa se imprime con sólo una barra en el lado
izquierdo, es decir, la barra de corchea del grupo como un todo.

@lilypond[quote,ragged-right,fragment,relative=1,verbatim]
{
  f8[ r16 f g a]
  f8[ r16
  \set stemLeftBeamCount = #1
  f g a]
}
@end lilypond


@snippets



@node Feathered beams
@subsubsection Feathered beams

@cindex barras progresivas
@funindex \featherDurations

Las barras progresivas se usan para indicar que un pequeño grupo de
notas se debe tocar a una velocidad creciente (o decreciente), sin
cambiar el tempo general de la pieza.  El ámbito de la barra progrsiva
se debe indicar manualmente usando @code{[} y @code{]}, el efecto de
ángulo de la barra se inicia especificando una dirección en la
propiedad @code{grow-direction} del objeto @code{Beam}.


Si queremos que la colocación de las notas y el sonido de la salida
MIDI refleje el ritardando o accelerando indicado por la barra
progresiva, las notas se deben agrupar como una expresión musical
delimitada por llaves y precedida de una instrucción
@code{featheredDurations} que especifica la razón entre las duraciones
de la primera y la última notas dentro del grupo.

Los corchetes rectos muestran el ábito de la barra y las llaves
muestran qué notas han de modificar sus duraciones.  Normalmente
delimitarían el mismo grupo de notas, pero no es un requisito: las dos
instrucciones son independientes.

En el ejemplo siguiente las ocho semicorcheas ocupan exactamente el
mismo tiempo que una blanca, pero la primera nota tiene la mitar de
duración que la última, con las notas intermedias alargándose
gradualmente.  Las cuatro primeras fusas se aceleran gradualmente,
mientras que las últimas cuatro fusas están a un tempo constante.

@lilypond[ragged-right,relative=1,fragment,verbatim,quote]
\override Beam #'grow-direction = #LEFT
\featherDurations #(ly:make-moment 2 1)
{ c16[ c c c c c c c] }
\override Beam #'grow-direction = #RIGHT
\featherDurations #(ly:make-moment 2 3)
{ c32[ d e f] }
% revert to non-feathered beams
\override Beam #'grow-direction = #'()
{ g32[ a b c] }
@end lilypond

@noindent
El espaciado en la salida impresa representa las duraciones de las
notas de una forma sólo aproximada, pero la salida MIDI es exacta.

@knownissues

La instrucción @code{\featherDurations} sólo funciona con fragmentos
musicales muy breves, y cuando los números de la fracción son
pequeños.

@seealso

Fragmentos de código:
@rlsr{Rhythms}.



@node Bars
@subsection Bars


@menu
* Bar lines::                   
* Bar numbers::                 
* Bar and bar number checks::   
* Rehearsal marks::             
@end menu



@node Bar lines
@subsubsection Bar lines

@cindex Barras de compás
@funindex \bar
@cindex líneas divisorias
@cindex repetición, barras de

Las líneas divisorias delimitan a los compases pero también se pueden
usar para indicar las repeticiones.  Normalmente se insertan de manera
automática.  Los saltos de línea solamente pueden producirse sobre las
barras de compás.

Se pueden forzar tipos especiales de línea divisoria con 
el comando @code{\bar}

@lilypond[quote,ragged-right,relative=2,fragment,verbatim]
c4 \bar "|:" c4
@end lilypond

Se encuentran disponibles los siguientes tipos de barra:

@c @lilypondfile[ragged-right,quote]{bar-lines.ly}

Además se puede especificar @code{"||:"}, que equivale a @code{"|:"}
excepto en los saltos de línea, en que produce una doble barra al
final de la línea y una repetición izquierda (de comienzo) al
principio de la línea siguiente.

Para permitir un salto de línea donde no hay ninguna línea divisoria
visible, utilice

@example
\bar ""
@end example

@noindent
De esta manera se insertará una barra invisible de compás y se hará
posible el salto de línea en este punto (sin incrementar el contador
de los números de compás).

En las partituras con muchos pentagramas, un comando @code{\bar} en
uno de ellos se aplica automáticamente a todos los demás.  Las líneas
resultantes se conectan entre los distintos pentagramas de un
@code{StaffGroup}, @code{PianoStaff} o @code{GrandStaff}.

@lilypond[quote,ragged-right,fragment,verbatim]
<<
  \new StaffGroup <<
    \new Staff {
      e'4 d'
      \bar "||"
      f' e'
    }
    \new Staff { \clef bass c4 g e g }
  >>
  \new Staff { \clef bass c2 c2 }
>>
@end lilypond


@commonprop

@funindex whichBar
@funindex repeatCommands
@funindex defaultBarType

El comando @code{\bar }@var{tipo_de_barra} es una forma corta de hacer
@code{\set Timing.whichBar = }@var{tipo_de_barra}.  Cuando
@code{whichBar} se establece con el valor de una cadena, se crea una
línea divisoria de ese tipo.

Una línea divisoria se crea cuando se establece la propiedad
@code{whichBar}.  Al comienzo del compás su valor se toma de
@code{Timing.defaultBarType}.  Los contenidos de los
@code{repeatCommands} se utilizan para sobreescribir a las barras de
compás por omisión.

Le recomendamos que utilice siempre @code{\repeat} para hacer
repeticiones.  Consulte @ref{Repeats}.


@seealso

Referencia de la notación:
@ref{Repeats},
@ref{System start delimiters}.

Referencia de funcionamiento interno:
@rinternals{BarLine} (creada al nivel de @rinternals{Staff} (pentagrama)),
@rinternals{SpanBar} (a través de los pentagramas).


@node Bar numbers
@subsubsection Bar numbers

@cindex compás, números de
@cindex números de compás
@funindex currentBarNumber

Por defecto, los números de compás se imprimen al principio de la
línea, excepto la primera.  El número propiamente dicho se almacena en
la propiedad @code{currentBarNumber}, que normalmente se actualiza
automáticamente para cada compás.  También se puede establecer
manualmente:

@lilypond[verbatim,ragged-right,quote,fragment,relative]
c1 c c c
\break
\set Score.currentBarNumber = #50
c1 c c c
@end lilypond


@snippets

@funindex barNumberVisibility
@cindex bar numbers, regular spacing

Los números de compás sólo se pueden imprimir en las líneas
divisorias; para imprimir un número de compás al principio de la
pieza, se debe añadir una línea divisoria vacía

@lilypond[verbatim,ragged-right,quote,fragment,relative]
\set Score.currentBarNumber = #50
\bar ""
\repeat unfold 4 {c4 c c c} \break
\repeat unfold 4 {c4 c c c}
@end lilypond

Los números de compás se pueden tipografiar a intervalos regulares en
vez de al principio de cada línea.

@c Esto queda ilustrado en el ejemplo
@c siguiente, cuyo código fuente se encuentra disponible como
@c @lsr{staff,making-bar-numbers-appear-at-regular-intervals.ly}.

@c @lilypondfile[ragged-right,quote]{bar-number-regular-interval.ly}

Los números de compás se pueden suprimir completamente quitando el
grabador de números de compás de la partitura.

@lilypond[verbatim,ragged-right,quote]
\layout {
  \context {
    \Score
    \remove "Bar_number_engraver"
  }
}
\relative c''{
c4 c c c \break
c4 c c c
}
@end lilypond


@seealso

Referencia de funcionamiento interno:
@rinternals{BarNumber}.

Fragmentos de código:
@rlsr{Rhythms}.


@knownissues

Los números de compás pueden colisionar con el corchete
@rinternals{StaffGroup}, si hay uno en la parte de arriba.  Para
solucionarlo, se puede usar la propiedad de relleno @code{padding} de
@rinternals{BarNumber} para colocar el número correctamente.


@node Bar and bar number checks
@subsubsection Bar and bar number checks

@cindex compás, comprobación de
@funindex barCheckSynchronize
@funindex |

Las comprobaciones de compás ayudan a detectar errores en las
duraciones.  Una comprobación de compás se escribe usando el símbolo
de la barra vertical, @code{|}, en cualquier lugar donde se espera que
caiga una línea divisoria.  Si se encuentran líneas de comprobación de
compás en otros lugares, se imprime una lista de advertencias en el
archivo log de registro, mostrando los números de línea y columna en
que han fallado las comprobaciones de compás.  En el siguiente
ejemplo, la segunda comprobación de compás avisará de un error

@example
\time 3/4 c2 e4 | g2 |
@end example

Las comprobaciones de compás también se pueden usar en la letra de las
canciones, por ejemplo

@example
\lyricmode @{
  \time 2/4
  Bri -- lla | Bri -- lla |
@}
@end example

Las duraciones incorrectas a menudo desbaratan la partitura
completamente, sobre todo si la música es polifónica, por ello el
mejor sitio para empezar a corregir la entrada es hacer un barrido en
busca de comprobaciones de compás fallidas y duraciones incorrectas.

@funindex |
@funindex pipeSymbol

También es posible redefinir la acción que se lleva a cabo cuando se
encuentra un símbolo de comprobación de compás o «símbolo de tubería»,
@code{|}, en el código de entrada, de forma que haga algo distinto a
una comprobación de compás.  Se hace asignando una expresión musical a
@code{pipeSymbol} («símbolo de tubería»).  En el ejemplo siguiente se
establece @code{|} de forma que inserte una doble línea divisoria
cuando aparece en el código de entrada, en vez de comprobar el final
de un compás.

@lilypond[quote,ragged-right,verbatim]
pipeSymbol = \bar "||"
{
  c'2 c'2 |
  c'2 c'2
  c'2 | c'2
  c'2 c'2
}
@end lilypond

Al copiar piezas musicales grandes puede servir de ayuda comprobar que
el número de compás de LilyPond corresponde al original desde el que
está copiando.  Esto se puede comprobar con @code{\barNumberCheck},
por ejemplo:

@verbatim
\barNumberCheck #123
@end verbatim

@noindent
imprimirá una advertencia si el @code{currentBarNumber} (número del
compás actual) no es 123 cuando se procesa.


@node Rehearsal marks
@subsubsection Rehearsal marks

@cindex ensayo, letras de
@cindex letras de ensayo
@funindex \mark

Para imprimir una letra de ensayo, utilice la orden @code{\mark}

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
c1 \mark \default
c1 \mark \default
c1 \mark #8
c1 \mark \default
c1 \mark \default
@end lilypond

@noindent
La letra@tie{}@q{I} se salta de acuerdo con las tradiciones de
grabado.  Si quiere incluir la letra @q{I}, use

@example
\set Score.markFormatter = #format-mark-alphabet
@end example

La letra de ensayo se incrementa automáticamente si usa @code{\mark
\default}, pero también puede utilizar un número entero como argumento
para establecer la indicación manualmente.  El valor que se utilizará
se almacena dentro de la propiedad @code{rehearsalMark}.

@cindex ensayo, letra de, formato
@cindex ensayo, letra de, estilo
@cindex estilo de la letra de ensayo
@cindex formato de la letra de ensayo
@cindex letra de ensayo, estilo
@cindex letra de ensayo, formato
@cindex marca de ensayo, estilo
@cindex marca de ensayo, formato

El estilo se define por medio de la propiedad @code{markFormatter}.
Es una función que toma como argumentos la marca en curso (un número
entero) y el contexto actual.  Debe devolver un objeto de marcado.  En
el ejemplo siguiente, se establece @code{markFormatter} con el valor
de un procedimiento enlatado.  Después de algunos compases, se
establece con el valor de una función que produce un número encerrado
en una caja.

@lilypond[fragment,quote,ragged-right,verbatim,relative=2]
\set Score.markFormatter = #format-mark-numbers
c1 \mark \default
c1 \mark \default
\set Score.markFormatter = #format-mark-box-numbers
c1 \mark \default
c1 \mark \default
c1
@end lilypond

El archivo @file{scm/@/translation@/-functions@/.scm} contiene las
definiciones de @code{format-mark-numbers} (el formato por omisión),
@code{format-mark-box-numbers}, @code{format-mark-letters} y
@code{format-mark-box-letters}.  Se pueden usar éstos como inspiración
para otras funciones de formateo.

Podemos utilizar @code{format-mark-barnumbers},
@code{format-mark-box-barnumbers} y
@code{format-mark-circle-barnumbers} para obtener números de compás en
lugar de números o letras secuenciales.

Otros estilos de marca de ensayo se pueden especificar de forma
manual:

@example
\mark "A1"
@end example

@noindent
@code{Score.markFormatter} no afecta a las marcas que se especifican
de esta forma.  Sin embargo, es posible aplicar un elemento
@code{\markup} a la cadena.

@example
\mark \markup@{ \box A1 @}
@end example

@cindex segno
@cindex coda
@cindex D.S al Fine

Los glifos musicales (como el segno) se pueden imprimir dentro de un
elemento @code{\mark}

@lilypond[fragment,quote,ragged-right,verbatim,relative]
c1 \mark \markup { \musicglyph #"scripts.segno" }
c1 \mark \markup { \musicglyph #"scripts.coda" }
c1 \mark \markup { \musicglyph #"scripts.ufermata" }
c1
@end lilypond

@noindent
Consulte @ref{The Feta font} para ver una lista de los símbolos que se
pueden imprimir con @code{\musicglyph}.

Para ver formas comunes de trucar la colocación de las marcas de
ensayo, consulte @ref{Text marks}.

@seealso

Fragmentos de código:
@rlsr{Rhythms}.

En este manual:
@ref{The Feta font},
@ref{Formatting text}.

Referencia de funcionamiento interno:
@rinternals{RehearsalMark}.

Archivos de inicio: @file{scm/@/translation@/-functions@/.scm}
contiene la definición de @code{format-mark-numbers} y de
@code{format-mark-letters}.  Se pueden usar como inspiración para
escribir otras funciones de formateo.

@c Ejemplos: @c @lsr{parts,rehearsal-mark-numbers.ly}


@node Special rhythmic concerns
@subsection Special rhythmic concerns


@menu
* Grace notes::                 
* Aligning to cadenzas::        
* Time administration::         
@end menu

@node Grace notes
@subsubsection Grace notes

@funindex \grace
@cindex ornamentos
@cindex mordentes
@cindex appoggiatura
@cindex acciaccatura

Los mordentes y notas de adorno son ornamentos escritos.  El más común es la
acciaccatura o mordente de una nota, que se debe tocar muy corta.  Se
denota mediante una corchea pequeña, ligada, con un corchete tachado o
atravesado por una barrita.  La appoggiatura es una nota de adorno que
toma una fracción fija de la nota principal, y se denota como una nota
pequeña, ligada, sin tachar.  Ambas se introducen con los comandos
@code{\acciaccatura} y @code{\appoggiatura}, como se muestra en el ejemplo siguiente

@lilypond[quote,ragged-right,relative=2,verbatim,fragment]
b4 \acciaccatura d8 c4 \appoggiatura e8 d4
\acciaccatura { g16[ f] } e4
@end lilypond

Ambas son formas especiales del comando @code{\grace}.  Al anteponer
esta palabra a una expresión musical se crea una nueva expresión, que
se imprime en un tipo más pequeño y no ocupa ningún tiempo lógico en el compás.

@lilypond[quote,ragged-right,relative=2,verbatim,fragment]
c4 \grace c16 c4
\grace { c16[ d16] } c2 c4
@end lilypond

@noindent
Al contrario que @code{\acciaccatura} y @code{\appoggiatura}, el comando
@code{\grace} no inicia una ligadura.

@cindex timing, internal

Internamente, la cuenta del tiempo para las notas de adorno se hace
utilizando un segundo contador, el contador @q{de adorno}.  Cada
instante en el tiempo comprende dos números racionales: uno denota el
tiempo lógico, y el otro denota el tiempo de adorno.  El ejemplo
anterior se muestra a continuación con vectores de tiempo

@lilypond[quote,ragged-right]
<<
  \relative c''{
    c4 \grace c16 c4 \grace {
    c16[ d16] } c2 c4
  }
  \new Lyrics \lyricmode {
    \override LyricText #'font-family = #'typewriter

    \markup { (0,0) } 4
    \grace { \markup {
      ( \fraction 1 4 , \fraction -1 16 ) } 16 }
    \markup { (\fraction 1 4 , 0 ) } 4
    \grace {
      \markup { (\fraction 2 4 , \fraction "-1" 8 ) } 16
      \markup { (\fraction 2 4 , \fraction "-1" 16 ) } 16
    }
    \markup { ( \fraction 2 4 , 0 ) }
  }
>>
@end lilypond

La colocación de las notas de adorno se sincroniza entre los distintos
pentagramas.  En el siguiente ejemplo, hay dos semicorcheas de adorno
por cada corchea de adorno

@lilypond[quote,ragged-right,relative=2,verbatim,fragment]
<< \new Staff { e4 \grace { c16[ d e f] } e4 }
   \new Staff { c4 \grace { g8[ b] } c4 } >>
@end lilypond

@funindex \afterGrace

Si quiere acabar una nota con un adorno, use el comando
@code{\afterGrace}.  Toma dos argumentos: la nota principal y las
notas de adorno que siguen a la nota principal.

@lilypond[ragged-right, verbatim,relative=2,fragment]
c1 \afterGrace d1 { c16[ d] } c4
@end lilypond

Esto pondrá las notas de adorno después de un @q{espacio} que dura 3/4
de la longitud de la nota principal.  La fracción 3/4 se puede cambiar
estableciendo @code{afterGraceFraction}, por ejemplo

@example
#(define afterGraceFraction (cons 7 8))
@end example

@noindent
pondrá la nota de adorno a 7/8 de la nota principal.

Se puede conseguir el mismo efecto de forma manual haciendo

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
\new Voice {
  << { d1^\trill_( }
     { s2 \grace { c16[ d] } } >>
  c4)
}
@end lilypond

@noindent
Ajustando la duración de la nota de desplazamiento (aquí es una
blanca), se ajusta el espacio entre la nota principal y la de adorno.

Una expresión musical @code{\grace} introduce ajustes de tipografía
especiales, por ejemplo para producir un tipo más pequeño y para fijar
las direcciones.  Por ello, cuando se introducen trucos para la
presentación, deben ir dentro de la expresión de adorno, por ejemplo:

@lilypond[quote,ragged-right,fragment,verbatim,relative=2]
\new Voice {
  \acciaccatura {
    \stemDown
    f16->
    \stemNeutral
  }
  g4
}
@end lilypond

@noindent
Las sobreescrituras (overrides) también se deben deshacer dentro de la
expresión de adorno.

La disposición de las expresiones de adorno se pueden cambiar a lo
largo de la música usando la función @code{add-grace-property}.  El
siguiente ejemplo suprime la definición de la dirección de la
@code{Stem} (plica) para este adorno, y así las plicas no siempre
apuntan hacia arriba.

@example
\new Staff @{
  #(add-grace-property 'Voice 'Stem 'direction '())
  @dots{}
@}
@end example

@noindent
Otra opción es modificar las variables @code{startGraceMusic},
@code{stopGraceMusic}, @code{startAcciaccaturaMusic},
@code{stopAcciaccaturaMusic}, @code{startAppoggiaturaMusic} y
@code{stopAppoggiaturaMusic}.  Hay más información en el archivo
@file{ly/@/grace@/-init@/.ly}.

@noindent
La barrita que cruza el corchete de las acciaccaturas se puede obtener
en otras situaciones mediante @code{\override Stem #'stroke-style =
#"grace"}.


@commonprop

Se puede forzar la alineación de las notas de adorno con las notas
normales de los otros pentagramasGrace notes may be forced to use
align with regular notes estableciendo @code{strict-grace-spacing} al
valor ##t:

@lilypond[verbatim,quote,relative=2]
<<
  \override Score.SpacingSpanner #'strict-grace-spacing = ##t
  \new Staff {
    c4
    \afterGrace c4 { c16[ c8 c16] }
    c4 r
  }
  \new Staff {
    c16 c c c c c c c c4 r
  }
>>
@end lilypond


@seealso

Referencia de funcionamiento interno:
@rinternals{GraceMusic}.


@knownissues

Una partitura que comienza con una expresión @code{\grace} requiere
una declaración explícita @code{\new Voice} pues en caso contrario la
nota principal y la de adorno acabarán en pentagramas distintos.

La sincronización de las notas de adorno también puede acarrear
sorpresas.  La notación de pentagramas, como armaduras, líneas
divisorias, etc., se sincronizan también.  Ponga cuidado cuando mezcle
pentagramas con adornos y sin adornos, por ejemplo

@lilypond[quote,ragged-right,relative=2,verbatim,fragment]
<< \new Staff { e4 \bar "|:" \grace c16 d4 }
   \new Staff { c4 \bar "|:" d4 } >>
@end lilypond

@noindent
Esto se puede remediar insertando desplazamientos de adorno de las
duraciones correspondientes en los otros pentagramas.  Para el ejemplo
anterior

@lilypond[quote,ragged-right,relative=2,verbatim,fragment]
<< \new Staff { e4 \bar "|:" \grace c16 d4 }
   \new Staff { c4 \bar "|:" \grace s16 d4 } >>
@end lilypond

Las secciones de adorno sólo se deben usar dentro de expresiones de
música secuenciales.  No están contemplados el anidado ni la
yuxtaposición de secciones de adorno, y podría producir caídas u otros
errores.



@node Aligning to cadenzas
@subsubsection Aligning to cadenzas

En un contexto orquestal, las cadenzas presentan un problema especial:
al construir una partitura que tiene una cadenza, todos los demás
instrumentos deben saltar tantas notas como la longitud de la cadenza,
pues en caso contrario empezarán demasiado pronto o tarde.

Una solución a este problema son las funciones @code{mmrest-of-length}
y @code{skip-of-length}.  Estas funciones de Scheme toman un fragmento
de música como argumento y generan un @code{\skip} o silencio
multicompás, de la longitud exacta del fragmento.  El uso de
@code{mmrest-of-length} se muestra en el ejemplo siguiente.

@lilypond[verbatim,ragged-right,quote]
cadenza = \relative c' {
  c4 d8 << { e f g } \\ { d4. } >>
  g4 f2 g4 g
}

\new GrandStaff <<
  \new Staff { \cadenza c'4 }
  \new Staff {
    #(ly:export (mmrest-of-length cadenza))
    c'4
  }
>>
@end lilypond


@node Time administration
@subsubsection Time administration

@cindex tiempo, administración
@cindex tiempo, control del (dentro de la partitura)
@cindex música sin medida
@cindex medida, música sin

@funindex currentBarNumber
@funindex measurePosition
@funindex measureLength

El tiempo está administrado por el @code{Timing_translator}, que de
forma predeterminada vive en el contexto de @code{Score}.  Se añade un
alias, @code{Timing}, al contexto en que se coloca el
@code{Timing_translator}.

Se usan las siguientes propiedades de @code{Timing} para seguir la
pista del tiempo dentro de la partitura.

@cindex compás, número de

@table @code
@item currentBarNumber
El número de compás en curso.  Para ver un ejemplo que muestra el uso
de esta propiedad, consulte @ref{Bar numbers}.

@item measureLength
La longitud de los compases dentro de la indicación actual de compás.
Para un 4/4 esto es@tie{}1, y para el 6/8 es 3/4.  Su valor determinad
cuándo se insertan las líneas divisorias y cómo se generan las barras
automáticas.

@item measurePosition
El punto en que nos encontramos dentro del compás.  Esta cantidad se
reinicia sustrayendo @code{measureLength} cada vez que se alcanza o se
excede @code{measureLength}.  Cuando eso ocurre, se incrementa
@code{currentBarNumber}.

@item timing
Si tiene un valor verdadero, las variables anteriores se actualizan a
cada paso de tiempo.  Cuando tiene un valor falso, el grabador se
queda en el compás actual indefinidamente.

@end table

La cuenta del tiempo se puede cambiar estableciendo el valor de
cualquiera de estas variables explícitamente.  En el siguiente
ejemplo, se imprime la indicación de compás predeterminada 4/4, pero
@code{measureLength} tiene está ajustado a 5/4.  En los 4/8 hasta el
tercer compás, la posición @code{measurePosition} se adelanta en 1/8
hasta 5/8, acortando ese compás en 1/8.  Entonces, la siguiente línea
divisoria cae en 9/8 en vez de hacerlo en 5/4.

@lilypond[quote,ragged-right,verbatim,relative,fragment]
\set Score.measureLength = #(ly:make-moment 5 4)
c1 c4
c1 c4
c4 c4
\set Score.measurePosition = #(ly:make-moment 5 8)
b4 b4 b8
c4 c1
@end lilypond

@noindent
Como lo ilustra el ejemplo, @code{ly:make-moment n m} construye una
duración de la fracción n/m de una redonda.  Por ejemplo,
@code{ly:make-moment 1 8} es una duración de una corchea y
@code{ly:make-moment 7 16} es la duración de siete semicorcheas.


@seealso

En este manual: @ref{Bar numbers}, @ref{Unmetered music}

Fragmentos de código:
@rlsr{Rhythms}.

Referencia de funcionamiento interno:
@rinternals{Timing_translator},
@rinternals{Score}.
