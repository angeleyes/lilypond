%!PS-Adobe-2.0: lilyponddefs.ps
% TODO:
%  * junk all magic, start-line/stop-line just: placebox @ x.y
%
% Functions for direct PostScript output

% /setgray { 1 add } bind def

% To let gs load fonts from builddir, do:
% export GS_LIB=$(pwd)/mf/out:/usr/share/texmf/fonts/type1/bluesky/cm


/set-ps-scale-to-lily-scale {
	lily-output-units output-scale mul
	lily-output-units output-scale mul scale
} bind def


/init-paper {
	gsave
	clippath pathbbox newpath
	/vsize exch def
	/hsize exch def pop pop pop
	% FIXME
	/top-margin 2 def
	hsize line-width sub 2 div /left-margin exch def
	grestore
} bind def


/place-box {
	/object exch def
	gsave
	% exch translate
	translate
	0 0 moveto
	object
	grestore
} bind def


% start-system
/start-system {
    gsave
} bind def

/start-page {
    gsave
    0
    vsize translate
} bind def


/stop-system {
	/the-line exch def
	the-line stroke grestore
} bind def


/end-lilypond-output {
%	showpage
} bind def


/init-lilypond-parameters {
	staff-line-thickness setlinewidth
	staff-height init-paper
} bind def


% end lilyponddefs.ps
