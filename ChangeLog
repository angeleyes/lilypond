2002-03-02  Han-Wen  <hanwen@cs.uu.nl>

	* lily/lily-guile.cc: isdir_b and isaxis_b changed to ly_axis_p,
	ly_dir_p

	* lily/music.cc (ly_get_mus_property): typechecking
	(ly_set_mus_property): idem
	(ly_make_music): idem
	(ly_music_name): idem

	* lily/chord.cc: use scm_reverse_x iso. gh_reverse()

	* lily/note-spacing.cc (stem_dir_correction): correction for
	same stem notes as well. 

	* lily/pitch.cc (pitch_transpose): stricter typechecking

	* mf/parmesan*mf: magnification fixes.

	* Documentation/topdocs/INSTALL.texi: update RedHat reqs

2002-03-01  Mats Bengtsson  <mats.bengtsson@s3.kth.se>

	* buildscripts/mf-to-table.py (postfixes): Output also .ly file
	documenting the font. (Doesn't work for parmesan at the moment)

	* Documentation/user/appendices.itely (The Feta font): Add list of
	Feta font symbols with names.

	* mf/GNUmakefile ($(outdir)/lilypond.map): Generate lilypond.map
	automatically

2002-03-01  Han-Wen  <hanwen@cs.uu.nl>

	* lily/translator-group.cc (ly_set_trans_property): typechecking
	(ly_get_trans_property): typechecking.

	* lily/font-metric.cc (ly_text_dimension): typechecking 
	(ly_find_glyph_by_name): idem.

	* scm/bass-figure.scm (brew-complete-figure): support for
	bracketed numbers.
	
	* lily/grob.cc (ly_get_paper_var): new function

2002-02-28  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* VERSION (PATCH_LEVEL): 1.5.35 released.

	* lily/lookup.cc (ly_bracket): Scheme function ly-bracket
	(bracket): New function.

	* lily/stem-engraver.cc (stop_translation_timestep): bugfix, unset
	stemLeftBeamCount, stemRightBeamCount in stead of using #<undefined> 

	* lily/third-try.cc (set_implicit_neighbor_columns): type checking
	bugfix.

	* lily/span-arpeggio-engraver.cc (stop_translation_timestep):
	typecheck bugfix. 

	* lily/grob.cc (ly_get_grob_property): be anal about types.
	(ly_set_grob_property): idem

	* lily/figured-bass-engraver.cc (process_music): move molecule
	building completely to Scheme

	* lily/include/musical-request.hh (class Bass_figure_req): Add
	class. 

	* lily/parser.yy (bass_figure): add support for space figure.

	* lily/molecule.cc (ly_molecule_combined_at_edge): be anal about types 

	* lily/font-metric.cc (ly_text_dimension): Scheme function ly-text-dimension

	* lily/molecule.cc (ly_fontify_atom): new function ly-fontify-atom
	(ly_align_to_x): new function ly-align-to!

	* lily/font-interface.cc (ly_font_interface_get_font): new Scheme
	function ly-get-font

	* mf/feta-nummer.mf: include normal-space dimension. 

	* lily/collision.cc (check_meshing_chords): don't merge collisions
	with whole notes.
	
	* lily/system-start-delimiter.cc (after_line_breaking): Bugfix:
	glyph is string.

2002-02-28  Mats Bengtsson  <matsb@matsb@s3.kth.se>

	* scm/tex.scm, scm/ps.scm (or): Bugfix, ps output with Guile 3.4

2002-02-28  Juergen Reuter  <reuter@ipd.uka.de>

	* mf/parmesan-heads.mf: bugfix: mensural note heads  (WARNING:
	font changed)

	* scm/output-lib.scm: bugfix: resort to neo_mensural chars rather
	than mensural chars

	* mf/parmesan-scripts.mf, mf/parmesan-generic.mf,
	scm/grob-description.scm: added mensural fermata symbol

2002-02-27  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* VERSION: 1.5.34 released.

	* lily/rest-engraver.cc (create_grobs): rests can have pitches.

	* lily/staff-symbol-referencer.cc (callback): assume that
	staff-position is unset in general.

	* input/regression/rest-pitch.ly: new file.

	* lily/parser.yy (simple_element): rests can have pitch. Syntax:
	a4\rest

2002-02-26  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* lily/scm-option.cc (set_lily_option): add internal-type-checks
	as Scheme option. Run regression test by default with
	internal-type-checking.

	* lily/separating-group-spanner.cc (find_musical_sequences):  removed.

	* lily/lily-guile.cc (type_check_assignment): changed functions.

	* scm/*description*.scm: be anal about typechecks. Some changes
	for internal variable names.

2002-02-25  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* scm/ps.scm: -f ps  output for GUILE 1.4 and 1.3.4

2002-02-25  Han-Wen  <hanwen@cs.uu.nl>

	* VERSION: 1.5.33 released.

	* mf/feta-macros.mf (flare_path): removed draw_flare, replace by
	flare_path everywhere (c-clef, numbers).	

	* lily/bar-number-engraver.cc (process_music): also print bar
	number if measure starts with grace note.	

	* input/regression/grace-bar-number.ly: new test.

2002-02-24  Han-Wen  <hanwen@cs.uu.nl>

	* lily/figured-bass-engraver.cc (stop_translation_timestep): reset
	rest as well.

	* scm/music-functions.scm (voicify-music):  split chords into
	different voices automatically.

	* lily/music.cc (ly_music_list_p): new function

	* lily/music-sequence.cc (do_relative_octave): robustification

	* scm/music-functions.scm: many utility functions 

	* lily/music.cc (ly_set_mus_property): add type checks to the
	Scheme property assignment.

	* buildscripts/lilypond-profile,lilypond-login.sh (TEXCONFIG):
	dvips fixes

	* mf/lilypond.map: .map file from Mats' page. 

2002-02-21  Juergen Reuter <reuter@ipd.uka.de>

	* Some more parmesan related fixes;

	* Custos: varying shape (in particular, stem length), depending on the
	  vertical position of the custos (on staffline / between stafflines);

	* Custos: added grob property "neutral-direction" (same semantics as
	  with stem); introduced new grob property "neutral-position";

	* Time-signature: print a warning when resorting to default layout.

2002-02-22  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* lily/translator-group.cc (add_fresh_simple_translator): remove
	function; initialize() is called through
	Translator_group::initialize().

	* lily/third-try.cc (prune_loose_colunms): add constraints (rods)
	for the neighbors of a loose column.

	* lily/line-of-score.cc (set_loose_columns): be more intelligent:
	position loose columns so that they don't collide.

2002-02-21  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* VERSION: 1.5.32 released.

	* scm/font.scm: remove font-name symbol.

	* mf/GNUmakefile: use pktrace for making PFAs

	* make/lilypond.redhat.spec.in: use pktrace when making RPMs

	* lily/rest-collision.cc (do_shift): read direction field from
	rest-column in case of note-rest collision. This should fix some
	problems with rest collisions.

2002-02-19  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* lily/note-heads-engraver.cc (process_music): Removed easyPlay
	property.

	* lily/note-head.cc (brew_ez_molecule): Remove note-character
	property. Read pitch directly from #'cause.

	* mf/feta-puntje.mf: bugfix

2002-02-19  Juergen Reuter <reuter@ipd.uka.de>
	
	* mf/*.mf: tried to fix ancient-font.ly. WARNING: Font changed.

2002-02-18  Jan Nieuwenhuizen  <janneke@gnu.org>

	* Documentation/windows/compiling.texi: Update.

	* Documentation/index.texi: Add link to orphaned compiling for
	windows page.

	* Documentation/footer.html.in: Comment fix.

	* stepmake/bin/add-html-footer.py: Python2.[12] re workarounds.

2002-02-18  Han-Wen  <hanwen@cs.uu.nl>
	
	* VERSION: 1.5.31 released

	* lily/new-spacing-spanner.cc: remove file.

	* lily/third-try.cc (do_measure): only take spacings into account
	if they pertain to the column pair under consideration. This fixes
	spacing bug when mixing eighths triplets and normal eighths.

	* lily/note-head.cc (brew_molecule): revert ledger change: ledger
	lines don't take up space anymore. Document why in note-head.cc
	comment.

2002-02-17  Han-Wen  <hanwen@cs.uu.nl>

	* lily/font-interface.cc (get_font): reinstate
	#'font-magnification. See input/regression/font-magnification.ly
	(get_font): Change the definition of  #'font-name grob property.

	* lily/grob.cc (get_uncached_molecule): output origin for grobs
	that have a #'cause field.

2002-02-12  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* Documentation/topdocs/INSTALL.texi: remove type3 stuff. 

	* mf/GNUmakefile:  remove metapost stuff

	* stepmake/aclocal.m4: remove metapost detection stuff.

2002-02-11  Jan Nieuwenhuizen  <janneke@gnu.org>

	* mf/GNUmakefile (FET_FILES): 
	(FONT_FILES): Include parmesan.

	* stepmake/bin/packagepython.py (make_assign_re): Bugfix.  Use re
	iso regex, regsub

	* buildscripts/clean-fonts.sh (FILES): Clean parmesan too.

	* Documentation/user/refman.itely (Paper size): Quote braces.

2002-02-07  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* stepmake/aclocal.m4: fixed bison version check to be more
	robust.

	* lily/stem.cc (position_noteheads): fix for cluster chords.

	* mf/*.mf: many blotting/pixel rounding fixes  by Rune Zedeler

	* python 2.2 support.

2002-02-04  Han-Wen  <hanwen@cs.uu.nl>

	* VERSION: 1.5.30 released

	* lily/dynamic-engraver.cc: add doco about DynamicLineSpanner

	* Documentation/user/refman.itely (Dynamics): add a note about
	DynamicLineSpanner.

	* scm/grob-description.scm: add a 'translator-type?  object
	property, so that \property Foo.Bar =\turnOff doesn't cause
	type check warning.

	* lily/translator-group.cc (add_fresh_group_translator): make
	new add-translator functions to make distinction between fresh and
	used group-translators. Fixes problem with scripts on auto-changing voice 

	* lily/timing-engraver.cc: make Timing_engraver instantiatable,
	add to Score_performer. Fixes bar checks in MIDI

	* lily/tie-engraver.cc (create_grobs): Use pitches to compare note
	heads. Fixes many quirks with ties.

	* lily/engraver.cc (announce_grob): Use SCM argument. Store cause
	in the grob property #'cause, instead of using Grob_info.

	* ly/engraver-init.ly (StaffContext): move Dot_column_engraver to
	staff context, fixing dot alignment on collisions.

	* lily/beam-engraver.cc (try_music): remove can't find beam start
	warning, so that skipTypesetting won't complain.

2002-02-01  Mats Bengtsson  <mats.bengtsson@s3.kth.se>

	* Documentation/user/refman.itely (Paper size): Documentation fix,
	papersize

	* lily/text-engraver.cc: Bugfix: textNonEmpty works again

	* scm/grob-description.scm: \breathe: Use feta font comma by default

2002-01-23  Mats Bengtsson  <mats.bengtsson@s3.kth.se>

	* input/template/piano-dynamics.ly (pedal): Simplified

2002-01-18  Mats Bengtsson  <mats.bengtsson@s3.kth.se>

	* ly/engraver-init.ly: avoid warnings on \skip in lyrics

2002-01-10  Mats Bengtsson  <matsb@s3.kth.se>

	* lilypond-mode.el (LilyPond-command-query): ignore case.

2002-02-01  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* VERSION: 1.5.29 released

	* all files: change 2001 to 2002 in headers globally

	* mf/parmesan20.mf: split out ancient notation into parmesan ("old
	cheese") font. WARNING: fonts changed.
	
2002-02-01  Juergen Reuter <reuter@ipd.uka.de>

	* mf/*.mf: Fixed some blot_diameter related flaws in some feta symbols
	
	* mf/*.mf: Added some more vaticana/solesmes style font symbols
	
	* mf/*.mf: Bugfix: renamed subbipunctum -> inclinatum

	* mf/*.mf: Fixed a few typos in various .mf files

2002-01-17 Rune Zedeler <rune@zedeler.dk>
 
 	* mf/: added macro soft_penstroke
	
 	       softened some glyphs
 	       redrawn triangular noteheads
 	       redrawn tab-clef
 	       added classical quarter rest
 	
 	* lily/stem.cc: Bugfix: Stem-attachment when staff_space!=1
 
 	* lily/bar.cc: Bugfix: repeat dots when even number of staff
 	lines and staff_space>=2
 
 	* lily/rest.cc: Use default rests when current style glyphs not
 	found - this allows
 	\property Staff.Rest \override #'style = #'classical

2002-01-30  Jan Nieuwenhuizen  <janneke@gnu.org>

	* input/bugs/first-tie.ly: New file.

	* input/bugs/spacing-clash.ly: New file.

2002-01-29  Jan Nieuwenhuizen  <janneke@gnu.org>

	* po: regenerate.

2002-1-24 Chris Jackson <chris@fluffhouse.org.uk>

	* lilypond-indent.el: New file providing indentation for
	parenthesised blocks of lilypond code in Emacs
	
	* lilypond-font-lock.el: Changes to the syntax table to facilitate
	indentation and handle block comments properly. Distinguish
	accents from close-brackets in fontification.

	* lilypond-mode.el: LilyPond-indent-command set appropriately.

2002-01-22  Jan Nieuwenhuizen  <janneke@gnu.org>

	* Documentation/windows/installing.texi: 
	* Documentation/windows/compiling.texi: Include from 1.4.10.

	* Documentation/windows/gs-profile.sh: previously lily-gs.sh

	* input/bugs/first-midi-tie.ly: New file.

2001-12-29  Han-Wen  <hanwen@cs.uu.nl>
	
	* VERSION: 1.5.28 released

        * lily/parser.yy (My_lily_parser): Slightly kludgy warning for
        illicit beams on [c4 c4] etc.

        * lily/bar-check-iterator.cc (Bar_check_iterator): new
        file. Make separate iterator for Bar_checks. Bar_check now happen
        outside engravers, meaning that you can use them with
        skipTypesetting. Associated changes in other files.
        
        * lily/new-spacing-spanner.cc (stem_dir_correction): removed
        function
        
        * lily/spacing-spanner.cc (stem_dir_correction): removed function

        * lily/include/grob.hh (unsmob_item, unsmob_spanner): Add functions

        * lily/bar.cc (before_line_breaking): remove bar-line spacing code.

        * lily/stem.cc (set_spacing_hints): removed function

        * lily/note-spacing.cc (stem_dir_correction): new stem-direction
        correction for spacing; now take vertical extents of the stem into
        account.  

        * lily/third-try.cc: More hacking to get spacing working.

        * lily/note-spacing-engraver.cc: new file, Note_spacing_engraver
        sits at staff level and creates note spacing objects. Scrap it
        again, and document why.

        * lily/include/group-interface.hh: rename functions. 

2001-12-27  Jan Nieuwenhuizen  <janneke@gnu.org>

	* stepmake/stepmake/c++-rules.make:
	* stepmake/stepmake/c-rules.make: Fixes for bison-1.28.

2001-12-25  Jan Nieuwenhuizen  <janneke@gnu.org>

	* make/lilypond-vars.make: 
	* scripts/ly2dvi.py (setup_environment): 
	* scripts/lilypond-book.py (setup_environment): Also set tex
	memory options.

2001-12-24  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* VERSION: 1.5.27 released.

	* Documentation/user/refman.itely (Bar numbers): added bar number
	documentation.

	* scm/font.scm (make-style-sheet): Fixes to make staff-sizes work
	again.

2001-12-22  Mats Bengtsson  <matsb@matsb@s3.kth.se>

	* tex/lilyponddefs.tex: Make sure interscorelinefill=1 doesn't
	spread the last few lines all over the last page of a score.

2001-12-24  Han-Wen  <hanwen@cs.uu.nl>

	* lily/third-try.cc: 3rd try at revising spacing
	engine. Not yet finished.

	* lily/paper-column.cc (brew_molecule): print debugging marks on a
	paper-column.

	* lily/tie-engraver.cc (class Tie_engraver): Use busyGrobs for
	collecting past note heads.

	* lily/note-heads-engraver.cc (try_music): Remove end_mom_
	stuff.

	* lily/grob-pq-engraver.cc (class Grob_pq_engraver): New file, new
	class. Keep a queue of grobs that are still playing in busyGrobs. 

	* lily/lyric-combine-music-iterator.cc (get_busy_status): New
	function. Use busyGrobs to detect playing notes.
	
2001-12-16  Jan Nieuwenhuizen  <janneke@gnu.org>
 
	* Documentation/topdocs/INSTALL.texi: Added note about broken
	python-2.1.  Updated note for Debian's broken (well, broken for
	our use anyway) tex configuration.
	
	* scripts/lilypond-book.py (re_dict): python2.2 fix.
	
	* stepmake/stepmake/c++-rules.make ($(outdir)/%.hh): 
	($(outdir)/%.cc): Adapted to bison-1.30; added bison < 1.30 fix.
	
	* scripts/lilypond-book.py (bounding_box_dimensions): Bugfix.
	(But left margin of png's still misses a few pixels.  Arg.)
	
2001-12-16  Heikki Junes  <hjunes@cc.hut.fi>

	* lilypond-mode.el (LilyPond-command-next-midi): Make
	possible to kill midi-process (using "C-c C-m").

2001-12-14  Han-Wen  <hanwen@cs.uu.nl>

	* scripts/lilypond-book.py (LatexPaper.set_geo_option):
	Convert strings with dimensions to numbers.

	* lily/volta-engraver.cc:  only make a  bracket for the top staff,
	as found in stavesFound. 

	* lily/bar-number-engraver.cc: remove staff administration. 

	* lily/mark-engraver.cc (acknowledge_grob): remove staff
	administration. This breaks support for invisible-staff.

	* lily/staff-collecting-engraver.cc: new engraver. Collects staff
	symbols into stavesFound.

	* lily/score-engraver.cc (acknowledge_grob): Acknowledge spacing
	grobs, and put them into columns.

	* lily/engraver-group-engraver.cc (acknowledge_grobs): Include the
	Engraver_group_engraver as a potential candidate for ack'ing grobs.

2001-12-13  Heikki Junes  <hjunes@cc.hut.fi>

	* lilypond-mode.el (LilyPond-command-next-midi): Play next (or last)
	midi section in the Emacs-mode, so it is possible to play certain
	score in a multiscore lilypond-file.
	 
2001-12-09  Rune Zedeler  <rune@zedeler.dk>
	* lily/lily-guile.cc: Added ly_assoc_front_x() and ly_assoc_cdr()
	(FIXME: not accessible from guile)
	
	* lily/accidental-engraver.cc: rewrote accidental-routines to get
	better support for Kurt Stone's suggestions.
	Removed properties: noResetKey, forgetAccidentals, autoReminders,
	                    lazyKeySignature.
	Changed property:   localKeySignature.
	Added properties:   extraNatural, autoAccidentals,
	                    autoCautionaries.

	(BUGFIX: broken-tie-support destroyed in 1.5.16)
	
	* ly/property-init.ly: added commands
	\defaultAccidentals \modernAccidentals \modernCautionaries
	\noResetKey \forgetAccidentals

	* ly/engraver-init.ly: Correct initialization of new accidentals.
	
	* scm/translator-property-description.scm: The new properties
	added.
	
	* input/: Some examples added, some changed.
	
	* Documentation/regression-test.tely: Added quick test of new
	accidentals.

2001-12-13  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* scripts/lilypond-book.py (scan_latex_preamble): don't crash if
	header not found

2001-12-07  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* lily/beam.cc (before_line_breaking): Make beams  without stems
	or with only one stem disappear.

2001-12-05  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* bibtools/bib2html.py: Add simple bib2html convertor, and .bst
	files to have standardised HTML bibliography output. Update build
	docs to reflect this.

	* lily/include/simple-spacer.hh (struct Simple_spacer): add
	active_count_, so that we don't have to look for active springs
	anymore.

	* scm/interface-description.scm,scm/grob-property-description.scm:
	Add 'penalty

	* lily/simple-spacer.cc (solve): Handle forced line breaks
	here. Fixes problems when combining linebreaks with non-fitting
	line configurations

2001-12-05  Jan Nieuwenhuizen  <janneke@gnu.org>

	* 1.4.9.jcn3 forward ports.
	
	* Really included .cvsignore.

	* Included Han-Wen's uu1 windows fixes.

	* Bugfix: lilypond-profile.sh: append to GS_FONTPATH, GS_LIB.

	* Added Cygwin setup.hint

	* Removed tex, python wrappers and postinstalls to go with Cywgin's
	tetex/texmf, python installations.

	* Updated cygwin installer.

	* ly2dvi: Don't accept filenames with spaces (+ fix).

2001-12-03  Han-Wen  <hanwen@cs.uu.nl>

	* ly/engraver-init.ly (VoiceContext): fix text engraver ordering.

	* lily/translator-def.cc: Remove manual symbol caching.

	* lily/script-column.cc (before_line_breaking): robustness check:
	don't crash if no direction set.

	* scripts/pmx2ly.py: Key and clef change support (Laura Conrad)

	* scripts/pmx2ly.py (Parser.parse_header): more generic header
	parsing.


2001-12-01  Han-Wen  <hanwen@cs.uu.nl>

	* lily/note-head.cc (head_extent): added to compute width without
	ledger lines. By default, ledger lines take up width now.

	* input/regression/fingering.ly: demonstrate auto fingering.
	Horizontal placement is still buggy. 
	
	* lily/fingering-engraver.cc (class Fingering_engraver):
	added. Provides support for horizontal fingering scripts

	* lily/include/grob.hh: Naming: change parent_l() into get_parent()

	* lily/side-position-interface.cc (add_staff_support): add staff
	only for Y-axis side positions.

	* lily/parser.yy (request_chord): Fix mem leak.

	* lily/musical-request.cc (transpose): moved to Music::transpose()

	* lily/include/grob-info.hh: Change music pointer to SCM, so we
	can store grobs as grob-creation cause as well.

	* lily/group-interface.cc (add_thing): efficiency tweak: reuse
	handle when adding. Use precomputed symbols throughout lily.
	
	* lily/rhythmic-column-engraver.cc: make NoteSpacing grobs to keep
	track of spacing issues.

	* lily/separating-line-group-engraver.cc: make StaffSpacing grobs
	to keep track of staff spacing

2001-11-30  Jan Nieuwenhuizen <janneke@gnu.org>

	* Rewrote new conditional guile >= 1.5 compilation switches, to keep
	  code clean from conditionals and have a concentrated sets of
	  compatitility fixes for old guile versions.

	* Fixes for guile 1.4, including embedded ps.

2001-11-30  Han-Wen Nienhuys  <hanwen@cs.uu.nl>

	* lily/stanza-number-engraver.cc (process_music): allow pairs as
	well for markup texts.

	* lily/musical-request.cc (length_mom): kludge for null pointer.

	* scm/sketch.scm (sketch-output-expression): guile 1.4 compatibility

	* scm/lily.scm (sign): bugfix

	* CHANGES: Change log instated.

	* stepmake/add-html-footer.py: @BRANCH@ tag insertion.

