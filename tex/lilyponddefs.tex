%%
%% include file for LilyPond
%%
%% this file defines various macros to accomodate lilypond output
%%
%% let's not make par before endinput
%
% TeXbook ex 7.7
\def\ifundefined#1{\expandafter\ifx\csname#1\endcsname\relax}
%
% skip if included already
\def\SkipLilydefs{\endinput}
\ifundefined{EndLilyPondOutput}
        \def\EndLilyPondOutput{\csname bye\endcsname}
        \def\SkipLilydefs{}
\fi
\SkipLilydefs

% need to do some stuff to turn pagenumbering off
\ifundefined{documentclass}
        \input lilypond-plaintex
\else
        \input lilypond-latex
\fi


%
\def\botalign#1{\vbox to 0pt{\vss #1}}
\def\leftalign#1{\hbox to 0pt{#1\hss}}

\input feta20.tex

% Attempt to keep lilypiecetitle together with the piece:
\def\myfilbreak{\par\vfil\penalty200\vfilneg}

% stacked horizontal lines
\ifundefined{lilypondpaperinterscoreline}
        \def\lilypondpaperinterscoreline{16}
\fi
\ifundefined{lilypondpaperinterscorelinefill}
        \def\lilypondpaperinterscorelinefill{0}
\fi

\def\interscoreline{\vskip\lilypondpaperinterscoreline pt plus %
  \lilypondpaperinterscorelinefill fill\myfilbreak}

\def\placebox#1#2#3{%
        \botalign{\hbox{\raise #1\leftalign{\kern #2{}#3}}}}%

% Are we using PDFTeX?  If so, use pdf definitions to translate
% \embeddedps commands to embedded PDF.
\ifx\pdfoutput\undefined  
  \input lily-ps-defs
\else
  \pdfoutput=1
  \input lily-pdf-defs
\fi

\def\EndLilyPondOutput{%
 \vskip 0pt plus \lilypondpaperinterscorelinefill00 fill\csname bye\endcsname
}
\def\postheader{}

% need to do some stuff to turn pagenumbering off
% they seriously mess up  your fragments.

\ifx\csname nolilyfooter\endcsname\relax
        \message{[footer defined]}%
        \csname lilyfooter\texsuffix\endcsname%
\else
        \message{[footer empty]}
        \csname%
        nolilyfooter\texsuffix\endcsname
\fi

% If we must make titles, do so
\ifx\mustmakelilypondtitle\undefined\else\makelilypondtitle\fi
\ifx\mustmakelilypondpiecetitle\undefined\else\makelilypondpiecetitle\fi

% fix chord.cc::banter_str before removing these
\input fetdefs

\endinput
