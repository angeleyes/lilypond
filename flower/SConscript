# -*-python-*-

import glob
import os

Import ('env')
here = os.getcwd ()
reldir = str (Dir ('.').srcnode ())
os.chdir (reldir)
sources = glob.glob ('*.cc')
includes = glob.glob ('include/*.hh')
os.chdir (here)
outdir = os.path.join (env['build'], reldir, env['out'])

name = 'flower'
e = env.Copy ()
e.Append (CPPPATH = [outdir, 'include'])
if env['static']:
	e.Library (name, sources) 
if not env['static'] or env['shared']:
	e.SharedLibrary (name, sources)

all_sources = ['SConscript',] + sources + includes
all_sources = ['SConscript', 'GNUmakefile']
ballprefix = env['ballprefix'] + '/flower'
ball = Builder (prefix = ballprefix + '/', action = 'ln $SOURCE $TARGET')
et = env.Copy (BUILDERS = {'BALL': ball})
#et = env.Copy ()
ballize = map (et.BALL, all_sources)
tar = env.Tar (env['tarball'],
	       map (lambda x: os.path.join (ballprefix, x), all_sources))
